var ke=Object.defineProperty,Fe=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var fe=(y,w,S)=>w in y?ke(y,w,{enumerable:!0,configurable:!0,writable:!0,value:S}):y[w]=S,q=(y,w)=>{for(var S in w||(w={}))Re.call(w,S)&&fe(y,S,w[S]);if(pe)for(var S of pe(w))$e.call(w,S)&&fe(y,S,w[S]);return y},z=(y,w)=>Fe(y,Le(w));(function(){"use strict";const R=class R{static log(e,...t){this.DEBUG&&console.log(`[CommonInputSimulator] ${e}`,...t)}static warn(e,...t){this.DEBUG&&console.warn(`[CommonInputSimulator] ${e}`,...t)}static async fillInput(e,t){var a,o;if(!t){this.warn("fillInput: No value provided");return}this.log("fillInput: Starting",{element:e,value:t}),e.focus(),this.log("fillInput: Focused element"),await this.wait(50);const n=(a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:a.set,i=(o=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:o.set;e instanceof HTMLInputElement&&n?(n.call(e,t),this.log("fillInput: Used native input setter")):e instanceof HTMLTextAreaElement&&i?(i.call(e,t),this.log("fillInput: Used native textarea setter")):(e.value=t,this.log("fillInput: Used direct value assignment")),this.triggerInputEvents(e),this.log("fillInput: Triggered events"),await this.wait(100),e.blur(),this.log("fillInput: Blurred element - Complete")}static async fillSelect(e,t,n){const i=(n==null?void 0:n.retryCount)||0;if(!t||!e)return this.warn("fillSelect: Missing value or select element",{value:t,select:e}),!1;if(this.log("fillSelect: Starting",{value:t,searchable:n==null?void 0:n.searchable,retryCount:i,selectId:e.id,selectName:e.name}),i>=this.RETRY_ATTEMPTS)return this.warn(`fillSelect: Failed after ${this.RETRY_ATTEMPTS} attempts`),!1;if(n!=null&&n.searchable){this.log("fillSelect: Using searchable dropdown mode");const a=await this.fillSearchableSelect(e,t);return!a&&i<this.RETRY_ATTEMPTS-1?(this.log(`fillSelect: Retry attempt ${i+1}`),await this.wait(200),this.fillSelect(e,t,z(q({},n),{retryCount:i+1}))):(this.log("fillSelect: Searchable result:",a),a)}return this.log("fillSelect: Using standard select mode"),this.fillStandardSelect(e,t)}static fillStandardSelect(e,t){var a;if(e.options.length===0)return this.warn("fillStandardSelect: Select has no options"),!1;this.log("fillStandardSelect: Processing",{value:t,optionsCount:e.options.length,options:Array.from(e.options).map(o=>({value:o.value,text:o.text}))});const n=t.toLowerCase().trim(),i=[{name:"Exact value match",fn:o=>o.value.toLowerCase()===n},{name:"Exact text match",fn:o=>o.text.toLowerCase()===n},{name:"Exact text match (trimmed)",fn:o=>o.text.toLowerCase().trim()===n},{name:"Value contains",fn:o=>o.value.toLowerCase().includes(n)},{name:"Text contains",fn:o=>o.text.toLowerCase().includes(n)},{name:"Reverse contains",fn:o=>n.includes(o.text.toLowerCase().trim())},{name:"Fuzzy match",fn:o=>this.fuzzyMatch(o.text.toLowerCase(),n)}];for(const o of i){this.log(`fillStandardSelect: Trying strategy: ${o.name}`);for(let c=0;c<e.options.length;c++){const l=e.options[c];if(!(l.value===""||l.disabled)&&o.fn(l)){this.log("fillStandardSelect: Match found!",{strategy:o.name,option:{index:c,value:l.value,text:l.text}}),e.focus(),e.selectedIndex=c;const r=(a=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:a.set;return r&&(r.call(e,l.value),this.log("fillStandardSelect: Used native setter")),this.triggerSelectEvents(e),this.log("fillStandardSelect: Events triggered"),e.blur(),this.log("fillStandardSelect: Complete - Success"),!0}}}return this.warn("fillStandardSelect: No match found for value:",t),!1}static fuzzyMatch(e,t){const n=e.replace(/[^a-z0-9]/g,""),i=t.replace(/[^a-z0-9]/g,"");return n.includes(i)||i.includes(n)}static async fillSearchableSelect(e,t){this.log("fillSearchableSelect: Starting",{value:t,select:e}),e.focus(),this.log("fillSearchableSelect: Focused select"),await this.wait(150),e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),this.log("fillSearchableSelect: Dispatched mousedown"),await this.wait(100),e.click(),this.log("fillSearchableSelect: Clicked select"),await this.wait(500);const n=this.findCustomDropdown(e);if(n){if(this.log("fillSearchableSelect: Custom dropdown found",n),await this.fillCustomDropdown(n,t))return this.log("fillSearchableSelect: Custom dropdown filled successfully"),!0;this.warn("fillSearchableSelect: Custom dropdown fill failed, retrying..."),await this.wait(300),e.click(),await this.wait(500);const a=this.findCustomDropdown(e);if(a&&await this.fillCustomDropdown(a,t))return!0}else this.warn("fillSearchableSelect: No custom dropdown found, falling back to standard");return this.fillStandardSelect(e,t)}static findCustomDropdown(e){const t=e.parentElement;if(!t)return this.warn("findCustomDropdown: No parent element"),null;this.log("findCustomDropdown: Searching for dropdown...");const n=['[class*="menu"]:not([class*="hidden"])','[class*="Menu"]:not([class*="hidden"])','[class*="dropdown"]:not([class*="hidden"])','[class*="Dropdown"]:not([class*="hidden"])',".select__menu",".select__menu-list",".vs__dropdown-menu",".mat-select-panel",".mat-autocomplete-panel",".menu.transition.visible",'[role="listbox"]','[role="menu"]',".select2-results",".choices__list--dropdown"];for(const i of n){const a=t.querySelector(i)||document.querySelector(i);if(a&&this.isVisible(a))return this.log("findCustomDropdown: Found dropdown with selector:",i,a),a}return this.warn("findCustomDropdown: No dropdown found"),null}static isVisible(e){const t=window.getComputedStyle(e),n=t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null;return this.log("isVisible:",{element:e,visible:n}),n}static async fillCustomDropdown(e,t){var c;this.log("fillCustomDropdown: Starting",{dropdown:e,value:t}),await this.waitForOptions(e);const n=e.querySelector('input[type="text"], input[type="search"], input[class*="input"]');n&&n instanceof HTMLInputElement?(this.log("fillCustomDropdown: Search input found, typing value"),await this.typeIntoSearch(n,t),await this.wait(500),await this.waitForOptions(e)):this.log("fillCustomDropdown: No search input found");const i=this.getDropdownOptions(e);if(this.log("fillCustomDropdown: Found options",{count:i.length,options:i.map(l=>{var r;return{text:(r=l.textContent)==null?void 0:r.trim(),classes:l.className}})}),i.length===0)return this.warn("fillCustomDropdown: No options found after waiting"),!1;const a=t.toLowerCase().trim(),o=[{name:"Exact match",fn:l=>{var p,f;const r=((p=l.textContent)==null?void 0:p.toLowerCase().trim())||"",u=((f=l.getAttribute("value"))==null?void 0:f.toLowerCase())||"";return r===a||u===a}},{name:"Text contains",fn:l=>{var u;return(((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"").includes(a)}},{name:"Reverse contains",fn:l=>{var u;const r=((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"";return a.includes(r)&&r.length>2}},{name:"Fuzzy match",fn:l=>{var u;const r=((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"";return this.fuzzyMatch(r,a)}}];for(const l of o){this.log(`fillCustomDropdown: Trying strategy: ${l.name}`);for(const r of i)if(l.fn(r))return this.log("fillCustomDropdown: Match found!",{strategy:l.name,option:(c=r.textContent)==null?void 0:c.trim()}),r.scrollIntoView({block:"nearest",behavior:"smooth"}),this.log("fillCustomDropdown: Scrolled into view"),await this.wait(150),r.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0})),this.log("fillCustomDropdown: Dispatched mouse events"),await this.wait(100),r.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),await this.wait(50),r.click(),this.log("fillCustomDropdown: Clicked option"),await this.wait(200),this.log("fillCustomDropdown: Complete - Success"),!0}return this.warn("fillCustomDropdown: No matching option found"),!1}static async typeIntoSearch(e,t){var i;this.log("typeIntoSearch: Starting",{input:e,value:t}),e.focus(),this.log("typeIntoSearch: Focused input"),await this.wait(50);const n=(i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:i.set;n?(n.call(e,t),this.log("typeIntoSearch: Used native setter")):(e.value=t,this.log("typeIntoSearch: Used direct assignment")),this.triggerInputEvents(e),this.log("typeIntoSearch: Triggered events"),await this.wait(50),this.log("typeIntoSearch: Complete")}static getDropdownOptions(e){this.log("getDropdownOptions: Searching for options...");const t=['[class*="option"]:not([class*="hidden"])','[class*="Option"]:not([class*="hidden"])',".select__option",".vs__dropdown-option","mat-option",".mat-option",".item:not(.disabled)",'[role="option"]',".select2-results__option",".choices__item",'div[id*="option"]','div[id*="react-select"]'];for(const n of t){const i=Array.from(e.querySelectorAll(n)).filter(a=>this.isVisible(a)&&!a.classList.contains("disabled"));if(i.length>0)return this.log(`getDropdownOptions: Found ${i.length} options with selector: ${n}`),i}return this.warn("getDropdownOptions: No options found"),[]}static async waitForOptions(e){this.log("waitForOptions: Waiting for options to appear...");const t=Date.now();for(;Date.now()-t<this.WAIT_TIMEOUT;){if(this.getDropdownOptions(e).length>0){this.log("waitForOptions: Options appeared");return}await this.wait(100)}this.warn("waitForOptions: Timeout - no options appeared")}static triggerInputEvents(e){this.log("triggerInputEvents: Triggering events for input"),[new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}),new Event("change",{bubbles:!0,cancelable:!0}),new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}),new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerInputEvents: Failed to dispatch event",i)}})}static triggerSelectEvents(e){this.log("triggerSelectEvents: Triggering events for select"),[new Event("change",{bubbles:!0,cancelable:!0}),new Event("input",{bubbles:!0,cancelable:!0}),new MouseEvent("click",{bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerSelectEvents: Failed to dispatch event",i)}})}static wait(e){return new Promise(t=>setTimeout(t,e))}};R.WAIT_TIMEOUT=5e3,R.RETRY_ATTEMPTS=3,R.DEBUG=!0;let y=R;const w={prefix:{patterns:[/^prefix$/i,/title[\s_-]?prefix/i,/salutation/i,/honorific/i],priority:1,getValue:s=>s.personalInfo.prefix},firstName:{patterns:[/first[\s_-]?name/i,/fname/i,/forename/i,/given[\s_-]?name/i],priority:1,getValue:s=>s.personalInfo.firstName},middleName:{patterns:[/middle[\s_-]?name/i,/mname/i,/middle[\s_-]?initial/i],priority:1,getValue:s=>s.personalInfo.middleName},lastName:{patterns:[/last[\s_-]?name/i,/lname/i,/surname/i,/family[\s_-]?name/i],priority:1,getValue:s=>s.personalInfo.lastName},fullName:{patterns:[/full[\s_-]?name/i,/complete[\s_-]?name/i,/^name$/i,/applicant[\s_-]?name/i,/candidate[\s_-]?name/i],priority:2,getValue:s=>[s.personalInfo.prefix,s.personalInfo.firstName,s.personalInfo.middleName,s.personalInfo.lastName].filter(Boolean).join(" ")},email:{patterns:[/e?mail/i,/email[\s_-]?address/i,/contact[\s_-]?email/i,/work[\s_-]?email/i,/personal[\s_-]?email/i],priority:1,getValue:s=>s.personalInfo.email},password:{patterns:[/\bpassword\b/i,/\bpwd\b/i,/\bpasscode\b/i,/\bpassphrase\b/i],priority:1,getValue:s=>s.personalInfo.password||""},phone:{patterns:[/phone/i,/telephone/i,/mobile/i,/cell/i,/tel/i,/contact[\s_-]?number/i,/phone[\s_-]?number/i],priority:1,getValue:s=>{const{countryCode:e,number:t}=s.personalInfo.phone;return t?`${e||""} ${t}`.trim():""},handleSpecialCases:async(s,e)=>{var r;const t=s.closest('form, .form-group, .phone-input-container, [class*="phone"]')||((r=s.parentElement)==null?void 0:r.parentElement),n=s,{countryCode:i,number:a}=e.personalInfo.phone,o=`${i||""} ${a}`.trim();if(!t){await y.fillInput(n,o);return}const c=t.querySelector('select[name*="country" i], select[id*="country" i], select[name*="code" i], select[id*="code" i]'),l=t.querySelector('input[name*="country" i], input[id*="country" i], input[name*="code" i], input[id*="code" i]');if((c||l)&&i){if(c){if(await y.fillSelect(c,i,{searchable:!0})){await y.fillInput(n,a);return}}else if(l&&l!==n){await y.fillInput(l,i),await y.fillInput(n,a);return}}await y.fillInput(n,o)}},address:{patterns:[/address/i,/street/i,/addr/i],priority:1,getValue:s=>s.personalInfo.address},city:{patterns:[/city/i,/town/i,/municipality/i],priority:1,getValue:s=>s.personalInfo.city},state:{patterns:[/state/i,/province/i,/region/i,/county/i],priority:1,getValue:s=>s.personalInfo.state},postalCode:{patterns:[/postal[\s_-]?code/i,/zip[\s_-]?code/i,/postcode/i,/zip/i],priority:1,getValue:s=>s.personalInfo.postalCode},country:{patterns:[/country/i,/nation/i],priority:1,getValue:s=>s.personalInfo.country},nationality:{patterns:[/nationality/i,/citizen/i],priority:1,getValue:s=>s.personalInfo.nationality},gender:{patterns:[/^gender$/i,/sex/i],priority:1,getValue:s=>s.personalInfo.gender},linkedin:{patterns:[/linkedin/i],priority:1,getValue:s=>s.personalInfo.linkedInURL},twitter:{patterns:[/twitter/i],priority:1,getValue:s=>s.personalInfo.twitterURL},github:{patterns:[/github/i,/git[\s_-]?hub/i],priority:1,getValue:s=>s.personalInfo.githubURL},website:{patterns:[/website/i,/portfolio/i,/homepage/i,/url/i],priority:1,getValue:s=>s.personalInfo.website},currentSalary:{patterns:[/current[\s_-]?salary/i,/compensation/i],priority:1,getValue:s=>s.additionalInfo.currentSalary},expectedSalary:{patterns:[/expected[\s_-]?salary/i,/desired[\s_-]?salary/i,/salary[\s_-]?expectation/i,/remuneration[\s_-]?expectation/i],priority:1,getValue:s=>s.additionalInfo.expectedSalary},noticePeriod:{patterns:[/notice[\s_-]?period/i,/availability/i],priority:1,getValue:s=>s.additionalInfo.noticePeriod},earliestAvailableDate:{patterns:[/earliest[\s_-]?available/i,/start[\s_-]?date/i,/available[\s_-]?from/i,/join[\s_-]?date/i],priority:1,getValue:s=>s.additionalInfo.earliestAvailableDate},coverLetter:{patterns:[/cover[\s_-]?letter/i,/motivation/i,/introduction/i,/why[\s_-]?apply/i,/tell[\s_-]?us/i,/why[\s_-]?interested/i,/why[\s_-]?you[\s_-]?interested/i,/interest/i],priority:1,getValue:s=>s.additionalInfo.coverLetter},genderIdentity:{patterns:[/gender[\s_-]?identity/i],priority:1,getValue:s=>s.additionalInfo.genderIdentity},raceEthnicity:{patterns:[/race/i,/ethnicity/i,/ethnic/i],priority:1,getValue:s=>s.additionalInfo.raceEthnicity},sexualOrientation:{patterns:[/sexual[\s_-]?orientation/i,/orientation/i],priority:1,getValue:s=>s.additionalInfo.sexualOrientation},disabilityStatus:{patterns:[/disability/i,/disabled/i],priority:1,getValue:s=>s.additionalInfo.disabilityStatus},veteranStatus:{patterns:[/veteran/i,/military[\s_-]?service/i],priority:1,getValue:s=>s.additionalInfo.veteranStatus}};function S(s){var c;const e=((c=s.closest("label"))==null?void 0:c.textContent)||"",t=s.getAttribute("aria-label")||"",n=s.getAttribute("aria-labelledby");let i="";if(n){const l=document.getElementById(n);i=(l==null?void 0:l.textContent)||""}const a=[s.getAttribute("name"),s.getAttribute("id"),s.getAttribute("placeholder"),t,i,s.getAttribute("data-field"),s.getAttribute("autocomplete"),s.getAttribute("type"),e].filter(Boolean).join(" ");let o=null;for(const[l,r]of Object.entries(w))for(const u of r.patterns)u.test(a)&&(!o||r.priority<o.priority)&&(o={key:l,priority:r.priority});return(o==null?void 0:o.key)||null}class he{constructor(){this.openaiApiKey=null,this.answerOverrides=null}setApiKey(e){this.openaiApiKey=e}setAnswerOverrides(e){this.answerOverrides=e}getApiKey(){return this.openaiApiKey?this.openaiApiKey:null}log(e,t){}consumeAnswerOverrides(){if(!this.answerOverrides)return null;const e=this.answerOverrides;return this.answerOverrides=null,e}async analyzeAndAnswerQuestions(e,t){const n=new Map,i=this.consumeAnswerOverrides(),a=this.getApiKey();if(!a&&!i||e.length===0)return this.log("skipping: missing api key or no questions",{hasKey:!!a,hasOverrides:!!i,questionCount:e.length}),n;this.log("requesting answers",{questionCount:e.length});try{const o=i!=null?i:await this.getAIAnswers(e,t);this.log("responses received",{responseCount:o.length});let c=0;o.forEach(l=>{const r=l.question.replace(/\s*\(REQUIRED\)\s*$/i,"").trim(),u=e.find(p=>this.normalizeText(p.label)===this.normalizeText(r));if(u)if(c+=1,l.selectedIndices!==void 0&&u.type==="checkbox"){const p=l.selectedIndices.map(f=>`#${f}`).join(",");n.set(u.id,p)}else if(l.selectedIndex!==void 0){const p=`#${l.selectedIndex}`;n.set(u.id,p)}else n.set(u.id,l.answer)}),this.log("answers matched",{matchedCount:c})}catch(o){console.error("AI Error:",o)}return n}normalizeText(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/g,"")}async getAIAnswers(e,t){var a,o,c;const n=this.buildPrompt(e,t),i=this.getApiKey();if(!i)return[];console.log("[AI Prompt]",n),this.log("sending OpenAI request",{questionCount:e.length});try{const l=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:'You are answering job applications for a senior software engineer with 10+ years of comprehensive experience across all modern technologies, platforms, and domains. The candidate is applying through job board platforms (LinkedIn, Indeed, etc.), not through recruiters or referrals. Always answer with confidence and expertise. For SELECT questions: return {"answer": "text", "selectedIndex": number}. For CHECKBOX: return {"answer": "text", "selectedIndices": [numbers]}. Return JSON array format.'},{role:"user",content:n}],temperature:.7,max_tokens:2e3})});if(console.log("[autofill-engine]","response",l),!l.ok){const h=(await l.text().catch(()=>"")).trim()||"<empty response body>";throw new Error(`OpenAI API error: ${l.status} ${l.statusText} - ${h}`)}const u=(c=(o=(a=(await l.json()).choices)==null?void 0:a[0])==null?void 0:o.message)==null?void 0:c.content;if(console.log("[AI Response]",u),!u)throw new Error("No content in OpenAI response");const p=u.match(/\[[\s\S]*\]/);if(p){const f=JSON.parse(p[0]);return this.log("parsed response",{parsedCount:Array.isArray(f)?f.length:0}),Array.isArray(f)?f:[]}return[]}catch(l){const r=l instanceof Error?l.message:String(l),u=l instanceof Error?l.name:"UnknownError",p=l instanceof Error&&l.stack?l.stack.split(`
`).slice(0,3).join(" | "):void 0,f={name:u,message:r,stack:p,online:typeof navigator!="undefined"?navigator.onLine:void 0,url:"https://api.openai.com/v1/chat/completions"};return console.log("[AI Response]",`ERROR: ${JSON.stringify(f)}`),[]}}buildPrompt(e,t){var o,c,l,r,u,p,f,h,m,g,C,_;const n=e.map((d,O)=>{let T=`${O+1}. ${d.label}`;return d.required&&(T+=" (REQUIRED)"),d.options&&d.options.length>0&&(d.type==="checkbox"?T+=`
   Type: CHECKBOX
   Options: ${d.options.map((k,F)=>`[${F}] ${k}`).join(", ")}`:T+=`
   Type: SELECT
   Options: ${d.options.map((k,F)=>`[${F}] ${k}`).join(", ")}`),T}).join(`
`),i=((o=t.workExperience)==null?void 0:o.length)>0?t.workExperience.map(d=>[d.company?`Company: ${d==null?void 0:d.company}`:null,d.position?`Role: ${d==null?void 0:d.position}`:null,d!=null&&d.startDate||d!=null&&d.endDate?`Period: ${(d==null?void 0:d.startDate)||"N/A"} - ${(d==null?void 0:d.endDate)||"Present"}`:null,d.description?`Description: ${d==null?void 0:d.description}`:null].filter(Boolean).join(`
`)).join(`

`):((r=(l=(c=t.resume)==null?void 0:c.workExperience)==null?void 0:l.length)!=null?r:0)>0?((p=(u=t.resume)==null?void 0:u.workExperience)!=null?p:[]).map(d=>[d.companyTitle?`${d.companyTitle}`:null,d.roleTitle?`${d.roleTitle}`:null,d.startDate||d.endDate?`${d.startDate||"N/A"} - ${d.endDate||"Present"}`:null].filter(Boolean).join(`
`)).join(`

`):"Extensive software engineering background",a=((f=t.education)==null?void 0:f.length)>0?t.education.map(d=>[d!=null&&d.school?`University: ${d==null?void 0:d.school}`:null,d!=null&&d.degree?`Degree: ${d==null?void 0:d.degree}`:null,d!=null&&d.major?`Major: ${d==null?void 0:d.major}`:null,d!=null&&d.startDate||d!=null&&d.endDate?`Period: ${(d==null?void 0:d.startDate)||"N/A"} - ${(d==null?void 0:d.endDate)||"Present"}`:null,d!=null&&d.gpa?`GPA: ${d==null?void 0:d.gpa}`:null].filter(Boolean).join(`
`)).join(`

`):((g=(m=(h=t.resume)==null?void 0:h.education)==null?void 0:m.length)!=null?g:0)>0?((_=(C=t.resume)==null?void 0:C.education)!=null?_:[]).map(d=>[d.institution?`${d.institution}`:null,d.degree?`${d.degree}`:null,d.field?`${d.field}`:null,d.date?`${d.date}`:null].filter(Boolean).join(`
`)).join(`

`):"Computer Science degree";return`
CANDIDATE: ${t.personalInfo.firstName} ${t.personalInfo.lastName} - Senior Software Engineer with 10+ years experience
Contact: ${t.personalInfo.email} | ${t.personalInfo.phone.countryCode} ${t.personalInfo.phone.number}
Location: ${[t.personalInfo.city,t.personalInfo.state,t.personalInfo.country].filter(Boolean).join(", ")}

WORK HISTORY:
${i}

EDUCATION:
${a}

QUESTIONS:
${n}

INSTRUCTIONS:
You are a versatile senior engineer with expertise across ALL modern technologies and platforms. Answer with complete confidence.

RULES:
1. Technical questions: Always answer "Yes" or select positive options. Provide 5-10+ years experience for any technology.
2. Implementation questions: Confirm with specific technical details (e.g., "Yes, I've implemented [X] in production with [specific patterns/tools]")
3. Work authorization: Answer honestly based on actual status
4. Motivation questions: Show genuine interest in the company
5. Text answers: 40-150 words, assertive tone using "I have", "I've implemented", "I've successfully delivered"
6. NEVER use hedging language: "While I haven't", "Although not directly", "similar to", "transferable skills"

FORMAT:
- SELECT questions: {"question": "exact question text", "answer": "exact option text", "selectedIndex": 0}
- CHECKBOX questions: {"question": "exact question text", "answer": "Option1, Option2", "selectedIndices": [0, 2]}
- TEXT questions: {"question": "exact question text", "answer": "your detailed answer"}

Return ONLY valid JSON array:
[
  {"question": "Question 1 text", "answer": "Your answer"},
  {"question": "Select question", "answer": "Selected option", "selectedIndex": 0},
  {"question": "Checkbox question", "answer": "Opt1, Opt2", "selectedIndices": [0, 2]}
]
`}}const D=new he,I={fieldCollector:{formFields:['input[type="text"]:not([type="hidden"])','input[type="email"]','input[type="tel"]','input[type="url"]','input[type="number"]','input[type="checkbox"]','input[type="radio"]',"textarea","select"],labelContainers:[".form-group",".field",".input-wrapper",".select-shell",".select__container",'[class*="question"]'],labelElements:["label","legend",".label","h1","h2","h3","h4","h5","h6"],requiredIndicators:[".required",".asterisk",'[aria-label*="required"]'],checkboxWrappers:[".checkbox__wrapper"]},reactSelect:{container:[".select-shell",".select__container",".select"],control:[".select__control"],menuList:[".select__menu-list",".select_menu-list"],option:[".select__option"],input:[".select__input",'[role="combobox"][aria-autocomplete="list"]'],multiValueContainer:[".select__value-container--is-multi"]}},L={firstName:{patterns:[/first[_\s-]?name/i,/given[_\s-]?name/i,/fname/i],selector:'input[id*="first_name"], input[name*="first_name"]',getValue:s=>s.personalInfo.firstName},lastName:{patterns:[/last[_\s-]?name/i,/family[_\s-]?name/i,/surname/i,/lname/i],selector:'input[id*="last_name"], input[name*="last_name"]',getValue:s=>s.personalInfo.lastName},fullName:{patterns:[/full[_\s-]?name/i,/complete[_\s-]?name/i,/^name$/i,/applicant[_\s-]?name/i,/candidate[_\s-]?name/i],selector:'input[id*="name"], input[name*="name"]',getValue:s=>[s.personalInfo.prefix,s.personalInfo.firstName,s.personalInfo.middleName,s.personalInfo.lastName].filter(Boolean).join(" ")},preferredName:{patterns:[/preferred[_\s-]?(first[_\s-]?)?name/i,/nickname/i],selector:'input[id*="preferred_name"], input[name*="preferred"]',getValue:s=>s.personalInfo.firstName},email:{patterns:[/e?mail/i,/email[_\s-]?address/i],selector:'input[id="email"], input[name="email"], input[type="email"]',getValue:s=>s.personalInfo.email},phone:{patterns:[/phone/i,/mobile/i,/telephone/i,/cell/i,/phone[_\s-]?number/i],selector:'input[id="phone"], input[name="phone"], input[type="tel"]',getValue:s=>{const{number:e}=s.personalInfo.phone;return e||void 0}},contactNumber:{patterns:[/contact[_\s-]?number/i,/phone[_\s-]?number.*country[_\s-]?code/i],selector:'input[id="contactNumber"], input[name="contactNumber"], input[type="tel"]',getValue:s=>{const{countryCode:e,number:t}=s.personalInfo.phone;return`${e||""} ${t}`.trim()||void 0}},phoneCountry:{patterns:[/phone.*country/i,/country.*phone/i,/phone.*code/i,/dial.*code/i,/country.*code/i],selector:'select[id="country"], input[id="country"][type="text"]',getValue:s=>{const{countryCode:e}=s.personalInfo.phone;return e||void 0}},linkedIn:{patterns:[/linkedin/i,/linked[_\s-]?in/i],selector:'input[id*="linkedin"], input[name*="linkedin"]',getValue:s=>s.personalInfo.linkedInURL},website:{patterns:[/website/i,/portfolio/i,/personal[_\s-]?site/i,/url/i,/homepage/i],selector:'input[id*="website"], input[name*="website"], input[name*="url"]',getValue:s=>s.personalInfo.website},github:{patterns:[/github/i,/git[_\s-]?hub/i],selector:'input[id*="github"], input[name*="github"]',getValue:s=>s.personalInfo.githubURL},twitter:{patterns:[/twitter/i,/x\.com/i],selector:'input[id*="twitter"], input[name*="twitter"]',getValue:s=>s.personalInfo.twitterURL},address:{patterns:[/address/i,/street/i,/addr/i],selector:'input[id*="address"], input[name*="address"]',getValue:s=>s.personalInfo.address},city:{patterns:[/\blocation.*city\b/i,/\bcurrent.*city\b/i,/\bcity.*location\b/i],selector:'input[id="city"], input[name="city"]',getValue:s=>s.personalInfo.city},state:{patterns:[/^state$/i,/province/i,/region/i,/location.*state/i],selector:'input[id*="state"], input[name*="state"]',getValue:s=>s.personalInfo.state},postalCode:{patterns:[/postal[_\s-]?code/i,/zip[_\s-]?code/i,/postcode/i,/^zip$/i],selector:'input[id*="zip"], input[name*="postal"]',getValue:s=>s.personalInfo.postalCode},country:{patterns:[/\blocation.*country\b/i,/\bcurrent.*country\b/i,/\bcountry.*location\b/i,/\bcountry.*residence\b/i],selector:'select[id*="country"], input[id*="country"]',getValue:s=>s.personalInfo.country},school:{patterns:[/school/i,/university/i,/college/i,/institution/i,/alma[_\s-]?mater/i],selector:'select[id*="school"], input[id*="school"]',getValue:s=>{var e;return(e=s.education[0])==null?void 0:e.school}},degree:{patterns:[/degree/i,/qualification/i,/diploma/i,/education[_\s-]?level/i],selector:'select[id*="degree"], input[id*="degree"]',getValue:s=>{var e;return(e=s.education[0])==null?void 0:e.degree}},fieldOfStudy:{patterns:[/field[_\s-]?of[_\s-]?study/i,/major/i,/discipline/i,/concentration/i,/specialization/i],selector:'input[id*="field"], input[id*="major"], input[id*="discipline"]',getValue:s=>{var e;return(e=s.education[0])==null?void 0:e.major}},currentSalary:{patterns:[/current[\s_-]?salary/i,/current[\s_-]?compensation/i,/expected[\s_-]?annual[\s_-]?cash[\s_-]?compensation/i,/annual[\s_-]?compensation/i,/cash[\s_-]?compensation/i],selector:'input[id*="salary"], input[name*="compensation"]',getValue:s=>s.additionalInfo.currentSalary||s.additionalInfo.expectedSalary},coverLetter:{patterns:[/^cover[\s_-]?letter$/i,/^cover\s*letter\s*upload$/i,/^attach.*cover.*letter$/i],selector:'textarea[id*="cover"], textarea[name*="letter"]',getValue:s=>s.additionalInfo.coverLetter},hispanicEthnicity:{patterns:[/hispanic/i,/latino/i,/latina/i,/latinx/i,/hispanic.*ethnicity/i],selector:'select[id*="hispanic"], select[name*="ethnicity"], input[id*="hispanic_ethnicity"]',getValue:s=>s.additionalInfo.raceEthnicity},gender:{patterns:[/^gender$/i,/gender.*identity/i,/sex/i],selector:'select[id="gender"], input[id="gender"]',getValue:s=>s.personalInfo.gender},companyName:{patterns:[/^company.*name$/i,/^employer$/i,/^current.*employer$/i,/^company$/i],selector:'input[id*="question"]',getValue:s=>{var e;return(e=s.workExperience[0])==null?void 0:e.company}},gpa:{patterns:[/gpa/i,/grade[_\s-]?point/i],selector:'input[id*="gpa"]',getValue:s=>{var e;return(e=s.education[0])==null?void 0:e.gpa}},startDate:{patterns:[/start[_\s-]?date/i,/from[_\s-]?date/i,/begin[_\s-]?date/i],selector:'input[id*="start"], input[name*="start_date"]',getValue:s=>{var e,t;return((e=s.education[0])==null?void 0:e.startDate)||((t=s.workExperience[0])==null?void 0:t.startDate)}},endDate:{patterns:[/end[_\s-]?date/i,/to[_\s-]?date/i,/graduation[_\s-]?date/i,/completion[_\s-]?date/i],selector:'input[id*="end"], input[name*="end_date"], input[id*="graduation"]',getValue:s=>{var e,t;return((e=s.education[0])==null?void 0:e.endDate)||((t=s.workExperience[0])==null?void 0:t.endDate)}}};function me(s){var m;const e=s.getAttribute("id")||"",t=s.getAttribute("name")||"",n=s.getAttribute("aria-label")||"",i=s.getAttribute("placeholder")||"",a=s.getAttribute("aria-describedby"),o=s.getAttribute("aria-labelledby");let c="";if(a){const g=document.getElementById(a);c=(g==null?void 0:g.textContent)||""}let l="";if(o){const g=document.getElementById(o);l=(g==null?void 0:g.textContent)||""}const r=[...I.fieldCollector.labelContainers,".phone-input",".phone-input__country"].join(", "),u=(m=s.closest(r))==null?void 0:m.querySelector("label"),p=(u==null?void 0:u.textContent)||"",f=`${e} ${t} ${n} ${i} ${p} ${c} ${l}`.toLowerCase(),h=s.closest(".phone-input__country")!==null||s.closest(".phone-input")!==null||/country.*label/i.test(o||"")&&/phone/i.test(f);if(h&&e==="country")return"phoneCountry";for(const[g,C]of Object.entries(L))if(!(g==="country"&&h)){for(const _ of C.patterns)if(_.test(f))return g}return null}class ye{constructor(){this.selectors=I}joinSelectors(e){return e.join(", ")}matchesAnySelector(e,t){return t.some(n=>e.matches(n))}closestBySelectors(e,t){return t.length===0?null:e.closest(this.joinSelectors(t))}querySelectorByList(e,t){return t.length===0?null:e.querySelector(this.joinSelectors(t))}async parseCheckboxGroup(e){const t=e.querySelectorAll('input[type="checkbox"]');if(t.length===0)return null;const n=t[0],i=e.querySelector("legend"),a=i!=null&&i.textContent?this.cleanLabelText(i.textContent):this.extractFieldLabel(n),o=[];t.forEach(l=>{var u,p,f,h,m,g;let r=(p=(u=document.querySelector(`label[for="${l.id}"]`))==null?void 0:u.textContent)==null?void 0:p.trim();if(r||(r=(h=(f=l.nextElementSibling)==null?void 0:f.textContent)==null?void 0:h.trim()),!r){const C=this.closestBySelectors(l,this.selectors.fieldCollector.checkboxWrappers);C&&(r=(g=(m=C.querySelector("label"))==null?void 0:m.textContent)==null?void 0:g.trim())}r&&o.push(this.cleanLabelText(r))});const c=this.generateFieldKey(n);return this.log(`Parsed checkbox group - Label: "${a}", Options:`,o),{element:n,key:c,label:a,type:"checkbox",isRequired:this.isFieldRequired(n),options:o.length>0?o:void 0}}shouldSkipElement(e){const t=[/recaptcha/i,/g-recaptcha/i,/captcha/i,/hcaptcha/i,/cf-turnstile/i],n=[e.id,e.className,e.getAttribute("name")||"",e.getAttribute("data-test")||""].join(" ");return t.some(i=>i.test(n))}async parseFormField(e){const t=this.extractFieldLabel(e),n=this.determineFieldType(e),i=this.generateFieldKey(e);if(!n)return this.warn("Could not determine type for element:",e.id||e.name,e.tagName),null;const a=await this.extractFieldOptions(e,n);return{element:e,key:i,label:t,type:n,isRequired:this.isFieldRequired(e),options:a}}extractFieldLabel(e){const t=e.getAttribute("id");if(t){const o=document.querySelector(`label[for="${t}"]`);if(o!=null&&o.textContent)return this.cleanLabelText(o.textContent)}const n=e.getAttribute("aria-label");if(n)return this.cleanLabelText(n);const i=this.closestBySelectors(e,this.selectors.fieldCollector.labelContainers);if(i){const o=this.querySelectorByList(i,this.selectors.fieldCollector.labelElements);if(o!=null&&o.textContent)return this.cleanLabelText(o.textContent)}const a=e.getAttribute("placeholder");return a?this.cleanLabelText(a):this.cleanLabelText(e.getAttribute("name")||"Unknown Field")}cleanLabelText(e){return e.trim().replace(/\*/g,"").replace(/[:;]$/g,"").replace(/\s+/g," ").trim()}generateFieldKey(e){return me(e)}determineFieldType(e){return e instanceof HTMLTextAreaElement?"textarea":e instanceof HTMLSelectElement?"select":e instanceof HTMLInputElement?e.type==="checkbox"?"checkbox":e.type==="radio"?"radio":this.isReactSelectInput(e)?this.isMultiSelectInput(e)?"react-multi-select":"react-select":"text":null}isReactSelectInput(e){return e instanceof HTMLInputElement&&this.matchesAnySelector(e,this.selectors.reactSelect.input)}isMultiSelectInput(e){return(e.getAttribute("id")||"").includes("[]")||e.getAttribute("aria-multiselectable")==="true"||this.closestBySelectors(e,this.selectors.reactSelect.multiValueContainer)!==null}isFieldRequired(e){const t=this.closestBySelectors(e,this.selectors.fieldCollector.labelContainers),n=this.selectors.fieldCollector.requiredIndicators,i=!!(t&&n.length>0&&t.querySelector(this.joinSelectors(n)));return e.hasAttribute("required")||e.getAttribute("aria-required")==="true"||i}async extractFieldOptions(e,t){if(e instanceof HTMLSelectElement)return Array.from(e.options).map(n=>n.text.trim()).filter(n=>n.length>0);if(t==="react-select"||t==="react-multi-select")return await this.extractReactSelectOptions(e);if(e instanceof HTMLInputElement&&e.type==="checkbox"){const n=e.closest("fieldset");if(n){const i=n.querySelectorAll('input[type="checkbox"]'),a=[];return i.forEach(o=>{var l,r,u,p,f,h;let c=(r=(l=document.querySelector(`label[for="${o.id}"]`))==null?void 0:l.textContent)==null?void 0:r.trim();if(c||(c=(p=(u=o.nextElementSibling)==null?void 0:u.textContent)==null?void 0:p.trim()),!c){const m=this.closestBySelectors(o,this.selectors.fieldCollector.checkboxWrappers);m&&(c=(h=(f=m.querySelector("label"))==null?void 0:f.textContent)==null?void 0:h.trim())}c&&a.push(this.cleanLabelText(c))}),this.log(`Extracted ${a.length} checkbox options:`,a),a.length>0?a:void 0}}}async extractReactSelectOptions(e){try{this.log("extractReactSelectOptions: Starting",{id:e.id});const t=this.closestBySelectors(e,this.selectors.reactSelect.control),n=[];if(t?(n.push(t),this.log("extractReactSelectOptions: Found select__control"),t.parentElement&&n.push(t.parentElement)):(this.log("extractReactSelectOptions: select__control not found, using input"),n.push(e),e.parentElement&&n.push(e.parentElement)),n.length===0){this.warn("extractReactSelectOptions: No elements to click");return}let i=null;for(let r=0;r<n.length;r++){const u=n[r];this.log(`extractReactSelectOptions: Clicking attempt ${r+1}/${n.length}`),e.focus(),u.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),u.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),u.click(),await this.wait(50);for(let p=0;p<10;p++){if(i=this.findReactSelectMenu(e),i){this.log(`extractReactSelectOptions: Menu found after attempt ${p+1}`);break}await this.wait(100)}if(i)break}if(!i){this.warn("extractReactSelectOptions: Menu not found after all attempts");return}if(this.selectors.reactSelect.option.length===0){this.warn("extractReactSelectOptions: No option selectors configured");return}const a=this.joinSelectors(this.selectors.reactSelect.option),o=i.querySelectorAll(a),c=Array.from(o).filter(r=>this.isVisible(r)).map(r=>{var u;return((u=r.textContent)==null?void 0:u.trim())||""}).filter(r=>r.length>0);e.blur();const l=new KeyboardEvent("keydown",{key:"Escape",bubbles:!0});return e.dispatchEvent(l),await this.wait(100),this.log(`extractReactSelectOptions: Extracted ${c.length} options:`,c),c.length>0?c:void 0}catch(t){this.warn("extractReactSelectOptions: Error:",t);try{e.blur(),document.body.click()}catch(n){}return}}findReactSelectMenu(e){const t=this.closestBySelectors(e,this.selectors.reactSelect.container);if(!t)return null;for(const n of this.selectors.reactSelect.menuList){const i=t.querySelector(n);if(i&&this.isVisible(i))return i}return null}isVisible(e){const t=window.getComputedStyle(e);return t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null}wait(e){return new Promise(t=>setTimeout(t,e))}log(e,...t){}warn(e,...t){}async collectAllFormFields(){const e=this.joinSelectors(this.selectors.fieldCollector.formFields),t=document.querySelectorAll(e);this.log(`Found ${t.length} form elements matching selector`);const n=[],i=new Set;for(const a of t){if(this.shouldSkipElement(a)){this.log("Skipping element (captcha/hidden):",a.id||a.name);continue}if(a instanceof HTMLInputElement&&a.type==="checkbox"){const c=a.closest("fieldset");if(c&&!i.has(c)){i.add(c);const l=await this.parseCheckboxGroup(c);l&&n.push(l);continue}else if(!c){const l=await this.parseFormField(a);l&&n.push(l)}continue}const o=await this.parseFormField(a);o?(this.log(`Collected field: "${o.label}" (type: ${o.type}, key: ${o.key})`),n.push(o)):this.log("Failed to parse field:",a.id||a.name,a.type)}return this.log(`Total fields collected: ${n.length}`),n}}const P=new ye,$=(s,e)=>{};class ge{categorizeFields(e){const t=[],n=[],i=[];for(const a of e)this.isEducationField(a.element)?($(`Education: "${a.label}"`),n.push(a)):this.isCustomQuestion(a.element)?($(`Custom: "${a.label}" (matched as custom question)`),i.push(a)):a.key?($(`Standard: "${a.label}" (key: ${a.key})`),t.push(a)):($(`Custom: "${a.label}" (no key match)`),i.push(a));return{standard:t,education:n,custom:i}}isEducationField(e){const t=e.closest('.education--container, .education--form, [class*="education"]'),n=e.getAttribute("id")||"",i=e.getAttribute("name")||"";return t!==null||/school|degree|major|discipline|gpa|field.*study/i.test(`${n} ${i}`)}isCustomQuestion(e){const t=e.getAttribute("id")||"",n=e.getAttribute("name")||"",i=/questions?[_\[]/i;return i.test(t)||i.test(n)||e.closest('[data-test*="question"]')!==null}}const H=new ge,V=class V{static log(e,...t){this.DEBUG&&console.log(`[InputSimulator] ${e}`,...t)}static warn(e,...t){this.DEBUG&&console.warn(`[InputSimulator] ${e}`,...t)}static async fillInput(e,t){var a,o;if(!t){this.warn("fillInput: No value provided");return}this.log("fillInput: Starting",{element:e,value:t}),e.focus(),await this.wait(50);const n=(a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:a.set,i=(o=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:o.set;e instanceof HTMLInputElement&&n?n.call(e,t):e instanceof HTMLTextAreaElement&&i?i.call(e,t):e.value=t,this.triggerInputEvents(e),await this.wait(100),e.blur(),this.log("fillInput: Complete")}static async fillSelect(e,t){var a;if(!t||!e)return this.warn("fillSelect: Missing value or select element",{value:t,select:e}),!1;if(this.log("fillSelect: Starting",{value:t,selectId:e.id,selectName:e.name,optionsCount:e.options.length}),e.options.length===0)return this.warn("fillSelect: Select has no options"),!1;const n=t.toLowerCase().trim(),i=[{name:"Exact value match",fn:o=>o.value.toLowerCase()===n},{name:"Exact text match",fn:o=>o.text.toLowerCase()===n},{name:"Exact text match (trimmed)",fn:o=>o.text.toLowerCase().trim()===n},{name:"Value contains",fn:o=>o.value.toLowerCase().includes(n)},{name:"Text contains",fn:o=>o.text.toLowerCase().includes(n)},{name:"Reverse contains",fn:o=>n.includes(o.text.toLowerCase().trim())},{name:"Fuzzy match",fn:o=>this.fuzzyMatch(o.text.toLowerCase(),n)}];for(const o of i){this.log(`fillSelect: Trying strategy: ${o.name}`);for(let c=0;c<e.options.length;c++){const l=e.options[c];if(!(l.value===""||l.disabled)&&o.fn(l)){this.log("fillSelect: Match found!",{strategy:o.name,option:{index:c,value:l.value,text:l.text}}),e.focus(),e.selectedIndex=c;const r=(a=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:a.set;return r&&r.call(e,l.value),this.triggerSelectEvents(e),e.blur(),this.log("fillSelect: Complete - Success"),!0}}}return this.warn("fillSelect: No match found for value:",t),!1}static async fillReactSelect(e,t,n=!1){if(!e)return this.warn("fillReactSelect: Missing input element"),!1;const i=this.isMultiSelectInput(e);this.log("fillReactSelect: Starting",{id:e.id,value:t,isMulti:i,isEnableIndexSelection:n});const a=this.closestBySelectors(e,I.reactSelect.control),o=[];if(a)o.push(a),this.log("fillReactSelect: Found select__control element",{className:a.className,tagName:a.tagName}),a.parentElement&&(o.push(a.parentElement),this.log("fillReactSelect: Added select__control parent",{className:a.parentElement.className||"",tagName:a.parentElement.tagName}));else{this.log("fillReactSelect: select__control not found, falling back to input and parents"),o.push(e);let u=e.parentElement;u&&o.push(u)}if(o.length===0){const u=`fillReactSelect: No elements to click. Input ID: ${e.id||"none"}`;return this.warn(u),!1}let c=null;for(let u=0;u<o.length;u++){const p=o[u],f=this.matchesAnySelector(p,I.reactSelect.control);this.log(`fillReactSelect: Attempting to open dropdown (attempt ${u+1}/${o.length}):`,{element:p.tagName,className:p.className||"",isSelectControl:f}),e.focus(),p.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),p.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),p.click(),await this.wait(50),(f||p===e)&&!i&&t&&!n&&(await this.typeIntoReactSelectInput(e,t),await this.wait(50));for(let h=0;h<10;h++){if(c=this.findReactSelectMenu(e),c){this.log(`fillReactSelect: Menu found after clicking attempt ${u+1}`,{attempt:h+1});break}await this.wait(100)}if(c)break;this.log(`fillReactSelect: Menu did not appear after clicking attempt ${u+1}`)}if(!c){const u=`fillReactSelect: Menu not found after trying to click ${o.length} element(s). Input ID: ${e.id||"none"}, Selector: ${e.className||"none"}`;return this.warn(u),!1}this.log("fillReactSelect: Menu/listbox found",{tagName:c.tagName,className:c.className||"",role:c.getAttribute("role"),id:c.id||"",childrenCount:c.children.length});const l=this.getReactSelectOptions(c);if(l.length===0)return this.warn("fillReactSelect: No options found in menu"),!1;if(this.log(`fillReactSelect: Found ${l.length} options`),!t||t.trim()==="")return l.length>0?(this.log("fillReactSelect: Value is empty, selecting first option (default)"),await this.selectReactSelectOption(l[0]),!0):!1;const r=this.findMatchingReactSelectOption(l,t,n);return r?(await this.selectReactSelectOption(r),this.log("fillReactSelect: Complete - Success"),!0):i&&l.length>0?(this.log("fillReactSelect: No match found, selecting first option as fallback"),await this.selectReactSelectOption(l[0]),!0):(this.warn("fillReactSelect: No matching option found for value:",t),!1)}static async typeIntoReactSelectInput(e,t){var i;const n=(i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:i.set;n?n.call(e,t):e.value=t;try{e.dispatchEvent(new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}))}catch(a){e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}static findReactSelectMenu(e){const t=this.closestBySelectors(e,I.reactSelect.container);if(!t)return this.warn("findReactSelectMenu: Container not found"),null;for(const n of I.reactSelect.menuList){const i=t.querySelector(n);if(i&&this.isVisible(i))return this.log("findReactSelectMenu: Menu found",{className:i.className,role:i.getAttribute("role")}),i}return null}static getReactSelectOptions(e){if(I.reactSelect.option.length===0)return[];const t=this.joinSelectors(I.reactSelect.option),n=e.querySelectorAll(t),i=Array.from(n).filter(a=>this.isVisible(a));return this.log(`getReactSelectOptions: Found ${i.length} visible options`),i}static findMatchingReactSelectOption(e,t,n=!1){var c,l;const i=t.toLowerCase().trim(),a=this.normalizeSelectText(t);if(n){const r=this.parseOptionIndex(t,e.length);if(r!==null&&e[r])return this.log(`findMatchingReactSelectOption: Matched by index: ${r}`),e[r]}const o=[{name:"Exact match",fn:r=>r===i},{name:"Contains",fn:r=>r.includes(i)},{name:"Starts with",fn:r=>r.startsWith(i)},{name:"Reverse contains",fn:r=>i.includes(r)&&r.length>2},{name:"Fuzzy match",fn:r=>{const u=this.normalizeSelectText(r);return u.includes(a)||a.includes(u)}}];for(const r of o){this.log(`findMatchingReactSelectOption: Trying strategy: ${r.name}`);for(const u of e){const p=((c=u.textContent)==null?void 0:c.toLowerCase().trim())||"";if(r.fn(p))return this.log("findMatchingReactSelectOption: Match found!",{strategy:r.name,text:(l=u.textContent)==null?void 0:l.trim()}),u}}return null}static async selectReactSelectOption(e){e.scrollIntoView({block:"nearest",behavior:"smooth"}),await this.wait(80),e.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0})),await this.wait(50),e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),await this.wait(50),e.click(),await this.wait(200),this.log("selectReactSelectOption: Option selected")}static isMultiSelectInput(e){return(e.getAttribute("id")||"").includes("[]")||e.getAttribute("aria-multiselectable")==="true"||this.closestBySelectors(e,I.reactSelect.multiValueContainer)!==null}static matchesAnySelector(e,t){return t.some(n=>e.matches(n))}static closestBySelectors(e,t){return t.length===0?null:e.closest(this.joinSelectors(t))}static joinSelectors(e){return e.join(", ")}static normalizeSelectText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}static parseOptionIndex(e,t){const i=e.trim().match(/^(?:#|index:|option-)?(\d+)$/i);if(!i)return null;const a=Number(i[1]);return Number.isFinite(a)&&a>=0&&a<t?a:null}static fuzzyMatch(e,t){const n=e.replace(/[^a-z0-9]/g,""),i=t.replace(/[^a-z0-9]/g,"");return n.includes(i)||i.includes(n)}static isVisible(e){const t=window.getComputedStyle(e);return t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null}static triggerInputEvents(e){[new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}),new Event("change",{bubbles:!0,cancelable:!0}),new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}),new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerInputEvents: Failed to dispatch event",i)}})}static triggerSelectEvents(e){[new Event("change",{bubbles:!0,cancelable:!0}),new Event("input",{bubbles:!0,cancelable:!0}),new MouseEvent("click",{bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerSelectEvents: Failed to dispatch event",i)}})}static wait(e){return new Promise(t=>setTimeout(t,e))}};V.DEBUG=!1;let N=V;class we{async wait(e){return new Promise(t=>setTimeout(t,e))}async validateSelectValue(e,t){if(!t||!e)return!1;const n=t.toLowerCase().trim();for(let i=0;i<e.options.length;i++){const a=e.options[i];if(a.value===""||a.disabled)continue;const o=a.value.toLowerCase().trim(),c=a.text.toLowerCase().trim();if(o===n||c===n||o.includes(n)||c.includes(n)||n.includes(o)||n.includes(c))return!0}return!1}async validateReactSelectValue(e,t,n){if(!t||!n||n.length===0)return!1;const i=t.toLowerCase().trim(),a=this.normalizeSelectText(t);for(const o of n){const c=o.toLowerCase().trim(),l=this.normalizeSelectText(o);if(c===i||c.includes(i)||i.includes(c)||l.includes(a)||a.includes(l))return!0}return!1}normalizeSelectText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}async fillField(e,t){if(!t)return!1;try{switch(e.type){case"text":case"textarea":return await this.fillTextInput(e.element,t);case"select":return await this.fillSelectDropdown(e.element,t);case"react-select":return await this.fillReactSelect(e.element,t,!1,!1);case"react-multi-select":return await this.fillReactSelect(e.element,t,!0,!1);case"checkbox":return await this.fillCheckbox(e.element,t,!1);case"radio":return await this.fillRadio(e.element,t);default:return!1}}catch(n){return!1}}async fillFieldWithAI(e,t,n=!1){if(!t)return!1;try{switch(e.type){case"text":case"textarea":return await this.fillTextInput(e.element,t);case"select":return await this.fillSelectDropdown(e.element,t);case"react-select":return await this.fillReactSelect(e.element,t,!1,n);case"react-multi-select":return await this.fillReactSelect(e.element,t,!0,n);case"checkbox":return await this.fillCheckbox(e.element,t,n);case"radio":return await this.fillRadio(e.element,t);default:return!1}}catch(i){return!1}}async fillTextInput(e,t){return await N.fillInput(e,t),!0}async fillSelectDropdown(e,t){if(!t)return await this.selectFirstOption(e);const n=await N.fillSelect(e,t);return n||await this.selectFirstOption(e)}async selectFirstOption(e){var t;if(e.options.length===0)return!1;for(let n=0;n<e.options.length;n++){const i=e.options[n];if(i.value!==""&&!i.disabled){e.focus(),e.selectedIndex=n;const a=(t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:t.set;return a&&a.call(e,i.value),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.blur(),!0}}return!1}async fillReactSelect(e,t,n,i=!1){if(n){const a=this.splitMultiSelectValues(t);let o=!1;for(const c of a){const l=await N.fillReactSelect(e,c,i);o=o||l}return o}return await N.fillReactSelect(e,t,i)}splitMultiSelectValues(e){const t=e.trim();if(!t)return[];if(t.startsWith("[")&&t.endsWith("]"))try{const n=JSON.parse(t);if(Array.isArray(n))return n.map(i=>String(i).trim()).filter(Boolean)}catch(n){}return t.split(/[;,\n]+/).map(n=>n.trim()).filter(Boolean)}async fillCheckbox(e,t,n=!1){const i=e.closest("fieldset");if(i&&n){const o=Array.from(i.querySelectorAll('input[type="checkbox"]')),c=t.split(",").map(l=>{const u=l.trim().match(/^#?(\d+)$/);return u?parseInt(u[1],10):null}).filter(l=>l!==null&&l>=0&&l<o.length);if(c.length>0){for(const l of c){const r=o[l];r&&!r.checked&&(r.focus(),await this.wait(50),r.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),r.click(),r.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),await this.wait(100))}return!0}else return!1}const a=["true","yes","1","on"].includes(t.toLowerCase());return e.checked!==a&&(e.focus(),await this.wait(50),e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),e.click(),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),await this.wait(100)),!0}async fillRadio(e,t){var i;const n=document.querySelectorAll(`input[type="radio"][name="${e.name}"]`);for(const a of n){const o=document.querySelector(`label[for="${a.id}"]`);if((((i=o==null?void 0:o.textContent)==null?void 0:i.trim())||"").toLowerCase().includes(t.toLowerCase()))return a.click(),await this.wait(100),!0}return!1}}const b=new we,M={"+1":{countryCode:"+1",countryName:"United States",countryISO:"US"},"+44":{countryCode:"+44",countryName:"United Kingdom",countryISO:"GB"},"+48":{countryCode:"+48",countryName:"Poland",countryISO:"PL"},"+49":{countryCode:"+49",countryName:"Germany",countryISO:"DE"},"+33":{countryCode:"+33",countryName:"France",countryISO:"FR"},"+39":{countryCode:"+39",countryName:"Italy",countryISO:"IT"},"+34":{countryCode:"+34",countryName:"Spain",countryISO:"ES"},"+86":{countryCode:"+86",countryName:"China",countryISO:"CN"},"+91":{countryCode:"+91",countryName:"India",countryISO:"IN"},"+81":{countryCode:"+81",countryName:"Japan",countryISO:"JP"},"+82":{countryCode:"+82",countryName:"South Korea",countryISO:"KR"},"+61":{countryCode:"+61",countryName:"Australia",countryISO:"AU"},"+64":{countryCode:"+64",countryName:"New Zealand",countryISO:"NZ"},"+7":{countryCode:"+7",countryName:"Russia",countryISO:"RU"},"+55":{countryCode:"+55",countryName:"Brazil",countryISO:"BR"},"+52":{countryCode:"+52",countryName:"Mexico",countryISO:"MX"},"+54":{countryCode:"+54",countryName:"Argentina",countryISO:"AR"},"+56":{countryCode:"+56",countryName:"Chile",countryISO:"CL"},"+57":{countryCode:"+57",countryName:"Colombia",countryISO:"CO"},"+27":{countryCode:"+27",countryName:"South Africa",countryISO:"ZA"},"+20":{countryCode:"+20",countryName:"Egypt",countryISO:"EG"},"+234":{countryCode:"+234",countryName:"Nigeria",countryISO:"NG"},"+254":{countryCode:"+254",countryName:"Kenya",countryISO:"KE"},"+30":{countryCode:"+30",countryName:"Greece",countryISO:"GR"},"+31":{countryCode:"+31",countryName:"Netherlands",countryISO:"NL"},"+32":{countryCode:"+32",countryName:"Belgium",countryISO:"BE"},"+41":{countryCode:"+41",countryName:"Switzerland",countryISO:"CH"},"+43":{countryCode:"+43",countryName:"Austria",countryISO:"AT"},"+45":{countryCode:"+45",countryName:"Denmark",countryISO:"DK"},"+46":{countryCode:"+46",countryName:"Sweden",countryISO:"SE"},"+47":{countryCode:"+47",countryName:"Norway",countryISO:"NO"},"+351":{countryCode:"+351",countryName:"Portugal",countryISO:"PT"},"+353":{countryCode:"+353",countryName:"Ireland",countryISO:"IE"},"+358":{countryCode:"+358",countryName:"Finland",countryISO:"FI"},"+420":{countryCode:"+420",countryName:"Czech Republic",countryISO:"CZ"},"+421":{countryCode:"+421",countryName:"Slovakia",countryISO:"SK"},"+36":{countryCode:"+36",countryName:"Hungary",countryISO:"HU"},"+40":{countryCode:"+40",countryName:"Romania",countryISO:"RO"},"+359":{countryCode:"+359",countryName:"Bulgaria",countryISO:"BG"},"+380":{countryCode:"+380",countryName:"Ukraine",countryISO:"UA"},"+90":{countryCode:"+90",countryName:"Turkey",countryISO:"TR"},"+971":{countryCode:"+971",countryName:"United Arab Emirates",countryISO:"AE"},"+966":{countryCode:"+966",countryName:"Saudi Arabia",countryISO:"SA"},"+972":{countryCode:"+972",countryName:"Israel",countryISO:"IL"},"+65":{countryCode:"+65",countryName:"Singapore",countryISO:"SG"},"+60":{countryCode:"+60",countryName:"Malaysia",countryISO:"MY"},"+66":{countryCode:"+66",countryName:"Thailand",countryISO:"TH"},"+84":{countryCode:"+84",countryName:"Vietnam",countryISO:"VN"},"+63":{countryCode:"+63",countryName:"Philippines",countryISO:"PH"},"+62":{countryCode:"+62",countryName:"Indonesia",countryISO:"ID"},"+92":{countryCode:"+92",countryName:"Pakistan",countryISO:"PK"},"+880":{countryCode:"+880",countryName:"Bangladesh",countryISO:"BD"},"+94":{countryCode:"+94",countryName:"Sri Lanka",countryISO:"LK"},"+977":{countryCode:"+977",countryName:"Nepal",countryISO:"NP"}},be=(s,e)=>{};function U(s){if(!s)return null;const e=s.trim(),t=e.startsWith("+")?e:`+${e}`;if(M[t])return M[t];for(const n of Object.keys(M))if(t.startsWith(n))return M[n];return null}function j(s,e){const t=U(e);if(!t)return-1;be(`[PhoneUtils] Searching for country: ${t.countryName} (${t.countryCode})`);const n=[t.countryCode,t.countryCode.slice(1),t.countryName.toLowerCase(),t.countryISO.toLowerCase()];if(s instanceof HTMLOptionsCollection)for(let i=0;i<s.length;i++){const a=s[i];if(a.disabled||a.value==="")continue;const o=a.text.toLowerCase().trim(),c=a.value.toLowerCase().trim(),l=`${o} ${c}`;for(const r of n)if(l.includes(r))return i}else for(let i=0;i<s.length;i++){const a=s[i].toLowerCase().trim();for(const o of n)if(a.includes(o))return i}return-1}const B=(s,e)=>{};class Se{async fillStandardFields(e,t){let n=0,i=0;const a=e.some(o=>o.key==="phoneCountry");B("start",{totalFields:e.length});for(const o of e){if(!o.key){i++;continue}const c=L[o.key];if(!c){i++;continue}let l=c.getValue(t);if(o.key==="phone"&&a&&l&&(l=t.personalInfo.phone.number||void 0),o.key==="phoneCountry"&&l){const u=U(l);if(u)l=u.countryCode;else{i++;continue}}if(o.type==="select"&&o.element instanceof HTMLSelectElement){if(!l){await b.selectFirstOption(o.element)?n++:i++;continue}if(!await b.validateSelectValue(o.element,l)){i++;continue}await b.fillField(o,l)?n++:i++;continue}if(o.type==="react-select"||o.type==="react-multi-select"){if(!l){i++;continue}if(!await b.validateReactSelectValue(o.element,l,o.options)){i++;continue}await b.fillField(o,l)?n++:i++;continue}if(!l){i++;continue}await b.fillField(o,l)?n++:i++}return B("complete",{total:e.length}),{filledCount:n,totalFields:e.length,unmatchedCount:i}}}const Ce=new Se,K=(s,e)=>{};class Ie{async fillEducationFields(e,t){var o;const n=(o=t.education)==null?void 0:o[0];if(!n)return K("skipping: no education data",{totalFields:e.length}),{filledCount:0,totalFields:e.length,unmatchedCount:e.length};let i=0,a=0;for(const c of e){const l=this.getEducationValue(c,n);if(!l){a++;continue}await b.fillField(c,l)?i++:a++}return K("complete",{total:e.length}),{filledCount:i,totalFields:e.length,unmatchedCount:a}}getEducationValue(e,t){var c,l;const n=e.label.toLowerCase(),i=((c=e.element.getAttribute("id"))==null?void 0:c.toLowerCase())||"",a=((l=e.element.getAttribute("name"))==null?void 0:l.toLowerCase())||"",o=`${n} ${i} ${a}`;return/school|university|college|institution/i.test(o)?t.school||null:/degree/i.test(o)?t.degree||null:/major|field|discipline/i.test(o)?t.major||null:/gpa/i.test(o)&&t.gpa?String(t.gpa):null}}const Ee=new Ie,ve=[{patterns:[/legally authorized to work/i,/work authorization/i,/authorized to work.*country/i,/legal.*work.*country/i,/authorized.*work.*employment/i],type:"react-select",index:0},{patterns:[/veteran.*status/i,/military.*service/i,/protected.*veteran/i],type:"react-select",index:0},{patterns:[/disability.*status/i,/disabled/i,/physical.*mental.*disability/i],type:"react-select",index:1},{patterns:[/^gender$/i,/gender identity/i,/gender.*select/i],type:"react-select",index:0},{patterns:[/hispanic.*latino/i,/are you hispanic/i,/hispanic\/latino/i,/latino.*latina/i],type:"react-select",index:1},{patterns:[/agree.*process.*data/i,/processes? my data/i,/privacy.*policy/i,/data.*processing/i,/consent.*data/i],type:"react-select",value:"Yes"},{patterns:[/retain.*data/i,/allow.*retain/i,/agree.*retain/i,/keep.*data/i],type:"checkbox",value:"true"},{patterns:[/where did you.*hear/i,/where did you.*see/i,/how did you.*hear/i,/source of.*vacancy/i,/source of.*job/i],type:"react-select",value:"LinkedIn"}];function Q(s,e){const t=s.toLowerCase().trim();for(const n of ve)if((n.type==="react-select"||n.type==="react-multi-select"?"react-select":n.type)===(e==="react-select"||e==="react-multi-select"?"react-select":e)){for(const o of n.patterns)if(o.test(t))return n}return null}function xe(s,e){if(s.type==="text"||s.type==="textarea")return s.value||null;if((s.type==="select"||s.type==="radio"||s.type==="react-select")&&s.index!==void 0)return`#${s.index}`;if(s.type==="checkbox"&&s.indices!==void 0){if(!e||e.length===0)return s.value||null;const t=s.indices.map(n=>n<0?e.length+n:n).filter(n=>n>=0&&n<e.length);return t.length>0?t.map(n=>`#${n}`).join(","):s.value||null}return s.value||null}const A=(s,e)=>{};class Oe{async collectAIQuestions(e,t){if(e.length===0)return[];const{fieldsNeedingAI:n}=await this.classifyFields(e,t);return n.map((i,a)=>({id:this.buildQuestionId(i,a),type:this.mapFieldTypeToQuestionType(i.type),label:i.label,required:i.isRequired,options:i.options}))}async fillCustomQuestions(e,t){if(e.length===0)return{filledCount:0,totalFields:0,unmatchedCount:0,aiQuestionsHandled:0};A("start",{totalFields:e.length}),A("field detection",{fields:e.map(r=>({label:r.label,type:r.type,options:r.options||[]}))});const{fieldsWithKeys:n,fieldsWithDefinitions:i,fieldsNeedingAI:a}=await this.classifyFields(e,t);A("routing summary",{withKeys:n.length,withDefinitions:i.length,needingAI:a.length});let o=0,c=0;for(const r of n){const u=L[r.key],p=u==null?void 0:u.getValue(t);if(p)if(r.type==="select"||r.type==="react-select"||r.type==="react-multi-select"){let f=-1;if(r.key==="phoneCountry"||r.key==="country"){const h=r.key==="phoneCountry"?t.personalInfo.phone.countryCode:null,m=r.key==="country"?t.personalInfo.country:null;r.key==="phoneCountry"&&h?r.type==="select"&&r.element instanceof HTMLSelectElement?f=j(r.element.options,h):r.options&&(f=j(r.options,h)):r.key==="country"&&m&&(r.type==="select"&&r.element instanceof HTMLSelectElement?f=await this.findSelectOptionIndex(r.element,m):r.options&&(f=this.findReactSelectOptionIndex(r.options,m)))}else r.type==="select"&&r.element instanceof HTMLSelectElement?f=await this.findSelectOptionIndex(r.element,p):(r.type==="react-select"||r.type==="react-multi-select")&&r.options&&(f=this.findReactSelectOptionIndex(r.options,p));if(f>=0){const h=`#${f}`;await b.fillFieldWithAI(r,h,!0)?o++:c++}else c++}else await b.fillField(r,p)?o++:c++;else c++}for(const r of i){const u=Q(r.label,r.type);if(u){const p=xe(u,r.options);if(p){const f=p.startsWith("#");await b.fillFieldWithAI(r,p,f)?o++:c++}else c++}}let l=0;if(a.length>0){A("sending questions to AI",{count:a.length});const r=a.map((p,f)=>({id:this.buildQuestionId(p,f),type:this.mapFieldTypeToQuestionType(p.type),label:p.label,required:p.isRequired,element:p.element,options:p.options}));A("ai questions",{questions:r.map(p=>({id:p.id,label:p.label,type:p.type,options:p.options}))});const u=await D.analyzeAndAnswerQuestions(r,t);A("AI answers received",{count:u.size});for(const p of a){const f=p.element.id||p.element.name||"",h=u.get(f);if(h){const m=h.startsWith("#")&&(p.type==="react-select"||p.type==="react-multi-select"||p.type==="checkbox");await b.fillFieldWithAI(p,h,m)?(o++,l++):c++}else c++}}return A("complete",{total:e.length}),{filledCount:o,totalFields:e.length,unmatchedCount:c,aiQuestionsHandled:l}}mapFieldTypeToQuestionType(e){switch(e){case"textarea":return"textarea";case"select":return"select";case"react-select":return"select";case"react-multi-select":return"multi_value_single_select";case"checkbox":return"checkbox";default:return"text"}}buildQuestionId(e,t){return e.element.id||e.element.name||`question_${t}`}async classifyFields(e,t){const n=[],i=[],a=[];for(const o of e){if(o.type==="select"||o.type==="react-select"||o.type==="react-multi-select"||o.type==="checkbox"){if(o.key){const c=L[o.key];if(c){const l=c.getValue(t);if(l&&o.options&&o.options.length>0){let r=!1,u=-1;if(o.type==="select"&&o.element instanceof HTMLSelectElement?(r=await b.validateSelectValue(o.element,l),r&&(u=await this.findSelectOptionIndex(o.element,l))):(o.type==="react-select"||o.type==="react-multi-select")&&(r=await b.validateReactSelectValue(o.element,l,o.options),r&&(u=this.findReactSelectOptionIndex(o.options,l))),r&&u>=0){n.push(o);continue}else{a.push(o);continue}}}}a.push(o);continue}o.key?n.push(o):Q(o.label,o.type)?i.push(o):a.push(o)}return{fieldsWithKeys:n,fieldsWithDefinitions:i,fieldsNeedingAI:a}}async findSelectOptionIndex(e,t){const n=t.toLowerCase().trim();for(let i=0;i<e.options.length;i++){const a=e.options[i];if(a.value===""||a.disabled)continue;const o=a.value.toLowerCase().trim(),c=a.text.toLowerCase().trim();if(o===n||c===n||o.includes(n)||c.includes(n))return i}return-1}findReactSelectOptionIndex(e,t){const n=t.toLowerCase().trim(),i=this.normalizeText(t);for(let a=0;a<e.length;a++){const o=e[a],c=o.toLowerCase().trim(),l=this.normalizeText(o);if(c===n||c.includes(n)||l.includes(i))return a}return-1}normalizeText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}}const G=new Oe,E=(s,e)=>{};class Ae{constructor(){this.profile=null}setProfile(e){this.profile=e}setOpenAIKey(e){D.setApiKey(e)}setAIAnswerOverrides(e){D.setAnswerOverrides(e)}async collectAIQuestions(){if(!this.profile)return[];const e=await P.collectAllFormFields(),t=H.categorizeFields(e),n=await this.getUnmatchedStandardFields(t.standard,this.profile),i=[...t.custom,...n];return G.collectAIQuestions(i,this.profile)}async autofillDomainPage(){if(!this.profile)return{filledCount:0,totalFields:0,unmatchedCount:0,aiQuestionsHandled:0};E("start",{profileId:this.profile.id||"unknown"});const e=await P.collectAllFormFields();E("field collection complete",{totalFields:e.length});const t=H.categorizeFields(e);E("field categorization complete",{standard:t.standard.length,education:t.education.length,custom:t.custom.length});const n=await Ce.fillStandardFields(t.standard,this.profile);E("standard fields filled",{filled:n.filledCount,total:n.totalFields,unmatched:n.unmatchedCount});const i=await this.getUnmatchedStandardFields(t.standard,this.profile);E("unmatched standard fields",{count:i.length});const a=[...t.custom,...i],o=await Ee.fillEducationFields(t.education,this.profile);E("education fields filled",{filled:o.filledCount,total:o.totalFields,unmatched:o.unmatchedCount});const c=await G.fillCustomQuestions(a,this.profile);E("custom fields filled",{filled:c.filledCount,total:c.totalFields,unmatched:c.unmatchedCount,aiQuestionsHandled:c.aiQuestionsHandled||0});const l=this.calculateTotals([n,o,c]);return E("greenhouse autofill complete",{filled:l.filledCount,total:l.totalFields,unmatched:l.unmatchedCount}),z(q({},l),{aiQuestionsHandled:c.aiQuestionsHandled||0})}async getUnmatchedStandardFields(e,t){const n=[];for(const i of e){if(!i.key)continue;const a=L[i.key];if(!a)continue;const o=a.getValue(t);i.type==="select"&&i.element instanceof HTMLSelectElement?o&&(await b.validateSelectValue(i.element,o)||n.push(i)):(i.type==="react-select"||i.type==="react-multi-select")&&o&&(await b.validateReactSelectValue(i.element,o,i.options)||n.push(i))}return n}calculateTotals(e){return e.reduce((t,n)=>({filledCount:t.filledCount+n.filledCount,totalFields:t.totalFields+n.totalFields,unmatchedCount:t.unmatchedCount+n.unmatchedCount}),{filledCount:0,totalFields:0,unmatchedCount:0})}}const v=new Ae;class _e{constructor(){this.profile=null,this.engineMode="auto"}setProfile(e){this.profile=e}setEngineMode(e){this.engineMode=e,console.log(`[AutofillEngine] Mode set to: ${e}`)}setOpenAIKey(e){v.setOpenAIKey(e)}setAIAnswerOverrides(e){v.setAIAnswerOverrides(e)}async collectDomainAIQuestions(){return this.profile?this.engineMode!=="greenhouse"&&!this.isTargetDomainPage()?[]:(v.setProfile(this.profile),v.collectAIQuestions()):[]}async autofillPage(){if(!this.profile)return console.warn("No profile set for autofill"),{filledCount:0,totalFields:0,unmatchedCount:0,unknownCount:0};console.log(`[AutofillEngine] Current mode: ${this.engineMode}`);try{this.isTargetDomainPage()}catch(e){if(e.message==="GREENHOUSE_IFRAME_REDIRECT")return console.log("[AutofillEngine] Redirected to Greenhouse iframe, stopping autofill"),{filledCount:0,totalFields:0,unmatchedCount:0,unknownCount:0};throw e}if(this.engineMode==="greenhouse"){console.log("[AutofillEngine] Forcing Greenhouse engine (mode: greenhouse)"),v.setProfile(this.profile);const e=await v.autofillDomainPage();return{filledCount:e.filledCount,totalFields:e.totalFields,unmatchedCount:e.unmatchedCount,unknownCount:0,aiQuestionsHandled:e.aiQuestionsHandled}}if(this.engineMode==="common")return console.log("[AutofillEngine] Forcing common engine (mode: common)"),await this.defaultAutofill();if(this.isTargetDomainPage()){console.log("[AutofillEngine] Detected Greenhouse page (mode: auto)"),v.setProfile(this.profile);const e=await v.autofillDomainPage();return{filledCount:e.filledCount,totalFields:e.totalFields,unmatchedCount:e.unmatchedCount,unknownCount:0,aiQuestionsHandled:e.aiQuestionsHandled}}return console.log("[AutofillEngine] Using common engine (mode: auto, no special page detected)"),await this.defaultAutofill()}isTargetDomainPage(){var i;const e=window.location.href.toLowerCase(),t=document.querySelectorAll("iframe");for(const a of t)if(console.log("iframe",a),(((i=a.src)==null?void 0:i.toLowerCase())||"").includes("greenhouse.io/embed/job_app"))throw window.open(a.src,"_blank"),new Error("GREENHOUSE_IFRAME_REDIRECT");return e.includes("greenhouse.io")?!0:[document.querySelector(".application--container"),document.querySelector(".application--form"),document.querySelector('form[id="application-form"]'),document.querySelector('[class*="greenhouse"]'),document.querySelector('footer.footer a[href*="greenhouse.com"]')].some(a=>a!==null)}async defaultAutofill(){const e=document.querySelectorAll('input:not([type="submit"]):not([type="button"]):not([type="image"]):not([type="hidden"]):not([type="checkbox"]):not([type="radio"]):not([type="file"]), textarea, select');let t=0,n=0,i=0;const a=e.length;console.log(`Found ${a} fillable fields`);for(const o of e){const c=S(o);if(c){const l=w[c];if(console.log(`Matched field: ${c} for element:`,o),l.handleSpecialCases)try{await l.handleSpecialCases(o,this.profile),t++}catch(r){console.error(`Error in special case handler for ${c}:`,r),n++}else{const r=l.getValue(this.profile);if(r)try{if(o instanceof HTMLSelectElement){const u=this.isSearchableSelect(o);await y.fillSelect(o,r,{searchable:u})?(t++,console.log(`Successfully filled ${c}: ${r}`)):(n++,console.warn(`Failed to fill ${c}, no matching option for: ${r}`))}else await y.fillInput(o,r),t++,console.log(`Successfully filled ${c}: ${r}`)}catch(u){console.error(`Error filling field ${c}:`,u),n++}else n++,console.log(`Matched field "${c}" but no value in profile for:`,o)}}else i++,console.log("Unknown field (no pattern match):",{element:o,name:o.getAttribute("name"),id:o.getAttribute("id"),placeholder:o.getAttribute("placeholder"),ariaLabel:o.getAttribute("aria-label")})}return console.log(`Autofilled ${t}/${a} fields, unmatched: ${n}, unknown: ${i}`),{filledCount:t,totalFields:a,unmatchedCount:n,unknownCount:i}}isSearchableSelect(e){const t=e.parentElement;return t?[t.querySelector('[class*="select"]'),t.querySelector('[class*="Select"]'),t.querySelector('[class*="dropdown"]'),t.querySelector('[class*="Dropdown"]'),t.classList.contains("v-select"),t.querySelector(".vs__dropdown-toggle"),t.querySelector("mat-select"),e.getAttribute("mat-select")!==null,t.classList.contains("ui")&&t.classList.contains("dropdown"),e.classList.contains("selectize-input"),e.classList.contains("select2-hidden-accessible")].some(i=>i):!1}}const x=new _e,W=s=>{var a,o,c,l,r,u,p,f,h,m,g,C,_,d,O,T,k,F,Y,J,X,Z,ee,te,ne,ie,oe,se,ae,re,le,ce,ue,de;const e=s&&typeof s=="object"?s:{},t=(a=e.personalInfo)!=null?a:{},n=(o=t.phone)!=null?o:{},i=(c=e.additionalInfo)!=null?c:{};return{id:(l=e.id)!=null?l:"",name:(r=e.name)!=null?r:"",personalInfo:{prefix:(u=t.prefix)!=null?u:"",firstName:(p=t.firstName)!=null?p:"",middleName:(f=t.middleName)!=null?f:"",lastName:(h=t.lastName)!=null?h:"",address:(m=t.address)!=null?m:"",city:(g=t.city)!=null?g:"",state:(C=t.state)!=null?C:"",postalCode:(_=t.postalCode)!=null?_:"",country:(d=t.country)!=null?d:"",email:(O=t.email)!=null?O:"",phone:{countryCode:(T=n.countryCode)!=null?T:"",number:(k=n.number)!=null?k:""},nationality:(F=t.nationality)!=null?F:"",linkedInURL:(Y=t.linkedInURL)!=null?Y:"",twitterURL:(J=t.twitterURL)!=null?J:"",githubURL:(X=t.githubURL)!=null?X:"",website:(Z=t.website)!=null?Z:"",gender:(ee=t.gender)!=null?ee:""},additionalInfo:{currentSalary:(te=i.currentSalary)!=null?te:"",expectedSalary:(ne=i.expectedSalary)!=null?ne:"",noticePeriod:(ie=i.noticePeriod)!=null?ie:"",earliestAvailableDate:(oe=i.earliestAvailableDate)!=null?oe:"",coverLetter:(se=i.coverLetter)!=null?se:"",genderIdentity:(ae=i.genderIdentity)!=null?ae:"",raceEthnicity:(re=i.raceEthnicity)!=null?re:"",sexualOrientation:(le=i.sexualOrientation)!=null?le:"",disabilityStatus:(ce=i.disabilityStatus)!=null?ce:"",veteranStatus:(ue=i.veteranStatus)!=null?ue:""},education:Array.isArray(e.education)?e.education:[],workExperience:Array.isArray(e.workExperience)?e.workExperience:[],resume:(de=e.resume)!=null?de:null}};async function Te(s,e){const t=W(s),n=e!=null?e:{},i=n.engineMode==="greenhouse"||n.engineMode==="common"?n.engineMode:"auto",a=typeof n.openaiApiKey=="string"?n.openaiApiKey.trim():"",o=Array.isArray(n.aiAnswerOverrides)?n.aiAnswerOverrides:null;x.setProfile(t),x.setEngineMode(i),x.setAIAnswerOverrides(o),a&&x.setOpenAIKey(a);let c="";const l=window.open;window.open=r=>(r&&(c=typeof r=="string"?r:r.toString()),null);try{const r=await x.autofillPage();return c?{success:!1,redirectUrl:c,engine:"greenhouse"}:{success:!0,engine:"aiQuestionsHandled"in r?"greenhouse":"common",filledCount:r.filledCount,totalFields:r.totalFields,unmatchedCount:r.unmatchedCount,unknownCount:r.unknownCount,aiQuestionsHandled:r.aiQuestionsHandled}}catch(r){return c?{success:!1,redirectUrl:c,engine:"greenhouse"}:{success:!1,error:r instanceof Error?r.message:"Autofill failed"}}finally{window.open=l}}async function Ne(s,e){const t=W(s),n=e!=null?e:{},i=n.engineMode==="greenhouse"||n.engineMode==="common"?n.engineMode:"auto";return x.setProfile(t),x.setEngineMode(i),x.collectDomainAIQuestions()}typeof window!="undefined"&&(window.autofillRuntime=Te,window.autofillCollectDomainQuestions=Ne)})();
