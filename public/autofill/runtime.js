var Pe=Object.defineProperty,ze=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var Ie=(S,I,A)=>I in S?Pe(S,I,{enumerable:!0,configurable:!0,writable:!0,value:A}):S[I]=A,K=(S,I)=>{for(var A in I||(I={}))Ue.call(I,A)&&Ie(S,A,I[A]);if(Ce)for(var A of Ce(I))Ke.call(I,A)&&Ie(S,A,I[A]);return S},Q=(S,I)=>ze(S,je(I));(function(){"use strict";const D=class D{static log(e,...t){this.DEBUG&&console.log(`[CommonInputSimulator] ${e}`,...t)}static warn(e,...t){this.DEBUG&&console.warn(`[CommonInputSimulator] ${e}`,...t)}static async fillInput(e,t){var s,o;if(!t){this.warn("fillInput: No value provided");return}this.log("fillInput: Starting",{element:e,value:t}),e.focus(),this.log("fillInput: Focused element"),await this.wait(50);const n=(s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:s.set,i=(o=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:o.set;e instanceof HTMLInputElement&&n?(n.call(e,t),this.log("fillInput: Used native input setter")):e instanceof HTMLTextAreaElement&&i?(i.call(e,t),this.log("fillInput: Used native textarea setter")):(e.value=t,this.log("fillInput: Used direct value assignment")),this.triggerInputEvents(e),this.log("fillInput: Triggered events"),await this.wait(100),e.blur(),this.log("fillInput: Blurred element - Complete")}static async fillSelect(e,t,n){const i=(n==null?void 0:n.retryCount)||0;if(!t||!e)return this.warn("fillSelect: Missing value or select element",{value:t,select:e}),!1;if(this.log("fillSelect: Starting",{value:t,searchable:n==null?void 0:n.searchable,retryCount:i,selectId:e.id,selectName:e.name}),i>=this.RETRY_ATTEMPTS)return this.warn(`fillSelect: Failed after ${this.RETRY_ATTEMPTS} attempts`),!1;if(n!=null&&n.searchable){this.log("fillSelect: Using searchable dropdown mode");const s=await this.fillSearchableSelect(e,t);return!s&&i<this.RETRY_ATTEMPTS-1?(this.log(`fillSelect: Retry attempt ${i+1}`),await this.wait(200),this.fillSelect(e,t,Q(K({},n),{retryCount:i+1}))):(this.log("fillSelect: Searchable result:",s),s)}return this.log("fillSelect: Using standard select mode"),this.fillStandardSelect(e,t)}static fillStandardSelect(e,t){var s;if(e.options.length===0)return this.warn("fillStandardSelect: Select has no options"),!1;this.log("fillStandardSelect: Processing",{value:t,optionsCount:e.options.length,options:Array.from(e.options).map(o=>({value:o.value,text:o.text}))});const n=t.toLowerCase().trim(),i=[{name:"Exact value match",fn:o=>o.value.toLowerCase()===n},{name:"Exact text match",fn:o=>o.text.toLowerCase()===n},{name:"Exact text match (trimmed)",fn:o=>o.text.toLowerCase().trim()===n},{name:"Value contains",fn:o=>o.value.toLowerCase().includes(n)},{name:"Text contains",fn:o=>o.text.toLowerCase().includes(n)},{name:"Reverse contains",fn:o=>n.includes(o.text.toLowerCase().trim())},{name:"Fuzzy match",fn:o=>this.fuzzyMatch(o.text.toLowerCase(),n)}];for(const o of i){this.log(`fillStandardSelect: Trying strategy: ${o.name}`);for(let c=0;c<e.options.length;c++){const l=e.options[c];if(!(l.value===""||l.disabled)&&o.fn(l)){this.log("fillStandardSelect: Match found!",{strategy:o.name,option:{index:c,value:l.value,text:l.text}}),e.focus(),e.selectedIndex=c;const r=(s=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:s.set;return r&&(r.call(e,l.value),this.log("fillStandardSelect: Used native setter")),this.triggerSelectEvents(e),this.log("fillStandardSelect: Events triggered"),e.blur(),this.log("fillStandardSelect: Complete - Success"),!0}}}return this.warn("fillStandardSelect: No match found for value:",t),!1}static fuzzyMatch(e,t){const n=e.replace(/[^a-z0-9]/g,""),i=t.replace(/[^a-z0-9]/g,"");return n.includes(i)||i.includes(n)}static async fillSearchableSelect(e,t){this.log("fillSearchableSelect: Starting",{value:t,select:e}),e.focus(),this.log("fillSearchableSelect: Focused select"),await this.wait(150),e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),this.log("fillSearchableSelect: Dispatched mousedown"),await this.wait(100),e.click(),this.log("fillSearchableSelect: Clicked select"),await this.wait(500);const n=this.findCustomDropdown(e);if(n){if(this.log("fillSearchableSelect: Custom dropdown found",n),await this.fillCustomDropdown(n,t))return this.log("fillSearchableSelect: Custom dropdown filled successfully"),!0;this.warn("fillSearchableSelect: Custom dropdown fill failed, retrying..."),await this.wait(300),e.click(),await this.wait(500);const s=this.findCustomDropdown(e);if(s&&await this.fillCustomDropdown(s,t))return!0}else this.warn("fillSearchableSelect: No custom dropdown found, falling back to standard");return this.fillStandardSelect(e,t)}static findCustomDropdown(e){const t=e.parentElement;if(!t)return this.warn("findCustomDropdown: No parent element"),null;this.log("findCustomDropdown: Searching for dropdown...");const n=['[class*="menu"]:not([class*="hidden"])','[class*="Menu"]:not([class*="hidden"])','[class*="dropdown"]:not([class*="hidden"])','[class*="Dropdown"]:not([class*="hidden"])',".select__menu",".select__menu-list",".vs__dropdown-menu",".mat-select-panel",".mat-autocomplete-panel",".menu.transition.visible",'[role="listbox"]','[role="menu"]',".select2-results",".choices__list--dropdown"];for(const i of n){const s=t.querySelector(i)||document.querySelector(i);if(s&&this.isVisible(s))return this.log("findCustomDropdown: Found dropdown with selector:",i,s),s}return this.warn("findCustomDropdown: No dropdown found"),null}static isVisible(e){const t=window.getComputedStyle(e),n=t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null;return this.log("isVisible:",{element:e,visible:n}),n}static async fillCustomDropdown(e,t){var c;this.log("fillCustomDropdown: Starting",{dropdown:e,value:t}),await this.waitForOptions(e);const n=e.querySelector('input[type="text"], input[type="search"], input[class*="input"]');n&&n instanceof HTMLInputElement?(this.log("fillCustomDropdown: Search input found, typing value"),await this.typeIntoSearch(n,t),await this.wait(500),await this.waitForOptions(e)):this.log("fillCustomDropdown: No search input found");const i=this.getDropdownOptions(e);if(this.log("fillCustomDropdown: Found options",{count:i.length,options:i.map(l=>{var r;return{text:(r=l.textContent)==null?void 0:r.trim(),classes:l.className}})}),i.length===0)return this.warn("fillCustomDropdown: No options found after waiting"),!1;const s=t.toLowerCase().trim(),o=[{name:"Exact match",fn:l=>{var d,p;const r=((d=l.textContent)==null?void 0:d.toLowerCase().trim())||"",u=((p=l.getAttribute("value"))==null?void 0:p.toLowerCase())||"";return r===s||u===s}},{name:"Text contains",fn:l=>{var u;return(((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"").includes(s)}},{name:"Reverse contains",fn:l=>{var u;const r=((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"";return s.includes(r)&&r.length>2}},{name:"Fuzzy match",fn:l=>{var u;const r=((u=l.textContent)==null?void 0:u.toLowerCase().trim())||"";return this.fuzzyMatch(r,s)}}];for(const l of o){this.log(`fillCustomDropdown: Trying strategy: ${l.name}`);for(const r of i)if(l.fn(r))return this.log("fillCustomDropdown: Match found!",{strategy:l.name,option:(c=r.textContent)==null?void 0:c.trim()}),r.scrollIntoView({block:"nearest",behavior:"smooth"}),this.log("fillCustomDropdown: Scrolled into view"),await this.wait(150),r.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0})),this.log("fillCustomDropdown: Dispatched mouse events"),await this.wait(100),r.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),await this.wait(50),r.click(),this.log("fillCustomDropdown: Clicked option"),await this.wait(200),this.log("fillCustomDropdown: Complete - Success"),!0}return this.warn("fillCustomDropdown: No matching option found"),!1}static async typeIntoSearch(e,t){var i;this.log("typeIntoSearch: Starting",{input:e,value:t}),e.focus(),this.log("typeIntoSearch: Focused input"),await this.wait(50);const n=(i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:i.set;n?(n.call(e,t),this.log("typeIntoSearch: Used native setter")):(e.value=t,this.log("typeIntoSearch: Used direct assignment")),this.triggerInputEvents(e),this.log("typeIntoSearch: Triggered events"),await this.wait(50),this.log("typeIntoSearch: Complete")}static getDropdownOptions(e){this.log("getDropdownOptions: Searching for options...");const t=['[class*="option"]:not([class*="hidden"])','[class*="Option"]:not([class*="hidden"])',".select__option",".vs__dropdown-option","mat-option",".mat-option",".item:not(.disabled)",'[role="option"]',".select2-results__option",".choices__item",'div[id*="option"]','div[id*="react-select"]'];for(const n of t){const i=Array.from(e.querySelectorAll(n)).filter(s=>this.isVisible(s)&&!s.classList.contains("disabled"));if(i.length>0)return this.log(`getDropdownOptions: Found ${i.length} options with selector: ${n}`),i}return this.warn("getDropdownOptions: No options found"),[]}static async waitForOptions(e){this.log("waitForOptions: Waiting for options to appear...");const t=Date.now();for(;Date.now()-t<this.WAIT_TIMEOUT;){if(this.getDropdownOptions(e).length>0){this.log("waitForOptions: Options appeared");return}await this.wait(100)}this.warn("waitForOptions: Timeout - no options appeared")}static triggerInputEvents(e){this.log("triggerInputEvents: Triggering events for input"),[new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}),new Event("change",{bubbles:!0,cancelable:!0}),new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}),new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerInputEvents: Failed to dispatch event",i)}})}static triggerSelectEvents(e){this.log("triggerSelectEvents: Triggering events for select"),[new Event("change",{bubbles:!0,cancelable:!0}),new Event("input",{bubbles:!0,cancelable:!0}),new MouseEvent("click",{bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerSelectEvents: Failed to dispatch event",i)}})}static wait(e){return new Promise(t=>setTimeout(t,e))}};D.WAIT_TIMEOUT=5e3,D.RETRY_ATTEMPTS=3,D.DEBUG=!0;let S=D;const I={prefix:{patterns:[/^prefix$/i,/title[\s_-]?prefix/i,/salutation/i,/honorific/i],priority:1,getValue:a=>a.personalInfo.prefix},firstName:{patterns:[/first[\s_-]?name/i,/fname/i,/forename/i,/given[\s_-]?name/i],priority:1,getValue:a=>a.personalInfo.firstName},middleName:{patterns:[/middle[\s_-]?name/i,/mname/i,/middle[\s_-]?initial/i],priority:1,getValue:a=>a.personalInfo.middleName},lastName:{patterns:[/last[\s_-]?name/i,/lname/i,/surname/i,/family[\s_-]?name/i],priority:1,getValue:a=>a.personalInfo.lastName},fullName:{patterns:[/full[\s_-]?name/i,/complete[\s_-]?name/i,/^name$/i,/applicant[\s_-]?name/i,/candidate[\s_-]?name/i],priority:2,getValue:a=>[a.personalInfo.prefix,a.personalInfo.firstName,a.personalInfo.middleName,a.personalInfo.lastName].filter(Boolean).join(" ")},email:{patterns:[/e?mail/i,/email[\s_-]?address/i,/contact[\s_-]?email/i,/work[\s_-]?email/i,/personal[\s_-]?email/i],priority:1,getValue:a=>a.personalInfo.email},password:{patterns:[/\bpassword\b/i,/\bpwd\b/i,/\bpasscode\b/i,/\bpassphrase\b/i],priority:1,getValue:a=>a.personalInfo.password||""},phone:{patterns:[/phone/i,/telephone/i,/mobile/i,/cell/i,/tel/i,/contact[\s_-]?number/i,/phone[\s_-]?number/i],priority:1,getValue:a=>{const{countryCode:e,number:t}=a.personalInfo.phone;return t?`${e||""} ${t}`.trim():""},handleSpecialCases:async(a,e)=>{var r;const t=a.closest('form, .form-group, .phone-input-container, [class*="phone"]')||((r=a.parentElement)==null?void 0:r.parentElement),n=a,{countryCode:i,number:s}=e.personalInfo.phone,o=`${i||""} ${s}`.trim();if(!t){await S.fillInput(n,o);return}const c=t.querySelector('select[name*="country" i], select[id*="country" i], select[name*="code" i], select[id*="code" i]'),l=t.querySelector('input[name*="country" i], input[id*="country" i], input[name*="code" i], input[id*="code" i]');if((c||l)&&i){if(c){if(await S.fillSelect(c,i,{searchable:!0})){await S.fillInput(n,s);return}}else if(l&&l!==n){await S.fillInput(l,i),await S.fillInput(n,s);return}}await S.fillInput(n,o)}},address:{patterns:[/address/i,/street/i,/addr/i],priority:1,getValue:a=>a.personalInfo.address},city:{patterns:[/city/i,/town/i,/municipality/i],priority:1,getValue:a=>a.personalInfo.city},state:{patterns:[/state/i,/province/i,/region/i,/county/i],priority:1,getValue:a=>a.personalInfo.state},postalCode:{patterns:[/postal[\s_-]?code/i,/zip[\s_-]?code/i,/postcode/i,/zip/i],priority:1,getValue:a=>a.personalInfo.postalCode},country:{patterns:[/country/i,/nation/i],priority:1,getValue:a=>a.personalInfo.country},nationality:{patterns:[/nationality/i,/citizen/i],priority:1,getValue:a=>a.personalInfo.nationality},gender:{patterns:[/^gender$/i,/sex/i],priority:1,getValue:a=>a.personalInfo.gender},linkedin:{patterns:[/linkedin/i],priority:1,getValue:a=>a.personalInfo.linkedInURL},twitter:{patterns:[/twitter/i],priority:1,getValue:a=>a.personalInfo.twitterURL},github:{patterns:[/github/i,/git[\s_-]?hub/i],priority:1,getValue:a=>a.personalInfo.githubURL},website:{patterns:[/website/i,/portfolio/i,/homepage/i,/url/i],priority:1,getValue:a=>a.personalInfo.website},currentSalary:{patterns:[/current[\s_-]?salary/i,/compensation/i],priority:1,getValue:a=>a.additionalInfo.currentSalary},expectedSalary:{patterns:[/expected[\s_-]?salary/i,/desired[\s_-]?salary/i,/salary[\s_-]?expectation/i,/remuneration[\s_-]?expectation/i],priority:1,getValue:a=>a.additionalInfo.expectedSalary},noticePeriod:{patterns:[/notice[\s_-]?period/i,/availability/i],priority:1,getValue:a=>a.additionalInfo.noticePeriod},earliestAvailableDate:{patterns:[/earliest[\s_-]?available/i,/start[\s_-]?date/i,/available[\s_-]?from/i,/join[\s_-]?date/i],priority:1,getValue:a=>a.additionalInfo.earliestAvailableDate},coverLetter:{patterns:[/cover[\s_-]?letter/i,/motivation/i,/introduction/i,/why[\s_-]?apply/i,/tell[\s_-]?us/i,/why[\s_-]?interested/i,/why[\s_-]?you[\s_-]?interested/i,/interest/i],priority:1,getValue:a=>a.additionalInfo.coverLetter},genderIdentity:{patterns:[/gender[\s_-]?identity/i],priority:1,getValue:a=>a.additionalInfo.genderIdentity},raceEthnicity:{patterns:[/race/i,/ethnicity/i,/ethnic/i],priority:1,getValue:a=>a.additionalInfo.raceEthnicity},sexualOrientation:{patterns:[/sexual[\s_-]?orientation/i,/orientation/i],priority:1,getValue:a=>a.additionalInfo.sexualOrientation},disabilityStatus:{patterns:[/disability/i,/disabled/i],priority:1,getValue:a=>a.additionalInfo.disabilityStatus},veteranStatus:{patterns:[/veteran/i,/military[\s_-]?service/i],priority:1,getValue:a=>a.additionalInfo.veteranStatus}};function A(a){var c;const e=((c=a.closest("label"))==null?void 0:c.textContent)||"",t=a.getAttribute("aria-label")||"",n=a.getAttribute("aria-labelledby");let i="";if(n){const l=document.getElementById(n);i=(l==null?void 0:l.textContent)||""}const s=[a.getAttribute("name"),a.getAttribute("id"),a.getAttribute("placeholder"),t,i,a.getAttribute("data-field"),a.getAttribute("autocomplete"),a.getAttribute("type"),e].filter(Boolean).join(" ");let o=null;for(const[l,r]of Object.entries(I))for(const u of r.patterns)u.test(s)&&(!o||r.priority<o.priority)&&(o={key:l,priority:r.priority});return(o==null?void 0:o.key)||null}const xe=a=>{try{const e=new WeakSet;return JSON.stringify(a,(t,n)=>{if(typeof n=="object"&&n!==null){if(e.has(n))return"[Circular]";e.add(n)}return typeof n=="function"?"[Function]":n},2)}catch(e){return String(a)}},b=(a,e)=>{if(typeof e=="undefined"){console.log(a);return}console.log(a,xe(e))};class Ee{constructor(){this.openaiApiKey=null,this.answerOverrides=null,this.answerDebug=null}setApiKey(e){this.openaiApiKey=e}setAnswerOverrides(e){this.answerOverrides=e}setAnswerDebug(e){this.answerDebug=e}getApiKey(){return this.openaiApiKey?this.openaiApiKey:null}log(e,t){b(`[AI] ${e}`,t)}consumeAnswerOverrides(){if(!this.answerOverrides)return null;const e=this.answerOverrides;return this.answerOverrides=null,e}consumeAnswerDebug(){if(!this.answerDebug)return null;const e=this.answerDebug;return this.answerDebug=null,e}logLargeText(e,t){t&&console.log(`[AI] ${e}
${t}`)}async analyzeAndAnswerQuestions(e,t){const n=new Map,i=this.consumeAnswerOverrides(),s=this.consumeAnswerDebug(),o=this.getApiKey();if(this.log("analyze: start",{questionCount:e.length,hasOverrides:!!i,hasApiKey:!!o}),!o&&!i||e.length===0)return this.log("skipping: missing api key or no questions",{hasKey:!!o,hasOverrides:!!i,questionCount:e.length}),n;(s!=null&&s.prompt||s!=null&&s.rawResponse)&&(this.logLargeText("AI prompt",s.prompt),this.logLargeText("AI response",s.rawResponse)),this.log("requesting answers",{questionCount:e.length});try{const c=i!=null?i:await this.getAIAnswers(e,t);i?this.log("using answer overrides",{count:c.length}):this.log("using OpenAI response",{count:c.length}),this.log("responses received",{responseCount:c.length});let l=0;c.forEach(r=>{const u=r.question.replace(/\s*\(REQUIRED\)\s*$/i,"").trim(),d=e.find(p=>this.normalizeText(p.label)===this.normalizeText(u));if(d)if(l+=1,r.selectedIndices!==void 0&&d.type==="checkbox"){const p=r.selectedIndices.map(h=>`#${h}`).join(",");n.set(d.id,p)}else if(r.selectedIndex!==void 0){const p=`#${r.selectedIndex}`;n.set(d.id,p)}else n.set(d.id,r.answer)}),this.log("answers matched",{matchedCount:l})}catch(c){console.error("AI Error:",c)}return n}normalizeText(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/g,"")}async getAIAnswers(e,t){var s,o,c;const n=this.buildPrompt(e,t),i=this.getApiKey();if(!i)return[];console.log("[AI Prompt]",n),this.log("sending OpenAI request",{questionCount:e.length});try{const l=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:'You are answering job applications for a senior software engineer with 10+ years of comprehensive experience across all modern technologies, platforms, and domains. The candidate is applying through job board platforms (LinkedIn, Indeed, etc.), not through recruiters or referrals. Always answer with confidence and expertise. For SELECT questions: return {"answer": "text", "selectedIndex": number}. For CHECKBOX: return {"answer": "text", "selectedIndices": [numbers]}. Return JSON array format.'},{role:"user",content:n}],temperature:.7,max_tokens:2e3})});if(console.log("[autofill-engine]","response",l),!l.ok){const h=(await l.text().catch(()=>"")).trim()||"<empty response body>";throw new Error(`OpenAI API error: ${l.status} ${l.statusText} - ${h}`)}const u=(c=(o=(s=(await l.json()).choices)==null?void 0:s[0])==null?void 0:o.message)==null?void 0:c.content;if(console.log("[AI Response]",u),!u)throw new Error("No content in OpenAI response");const d=u.match(/\[[\s\S]*\]/);if(d){const p=JSON.parse(d[0]);return this.log("parsed response",{parsedCount:Array.isArray(p)?p.length:0}),Array.isArray(p)?p:[]}return[]}catch(l){const r=l instanceof Error?l.message:String(l),u=l instanceof Error?l.name:"UnknownError",d=l instanceof Error&&l.stack?l.stack.split(`
`).slice(0,3).join(" | "):void 0,p={name:u,message:r,stack:d,online:typeof navigator!="undefined"?navigator.onLine:void 0,url:"https://api.openai.com/v1/chat/completions"};return console.log("[AI Response]",`ERROR: ${JSON.stringify(p)}`),[]}}buildPrompt(e,t){var o,c,l,r,u,d,p,h,m,g,y,w;const n=e.map((f,E)=>{let v=`${E+1}. ${f.label}`;return f.required&&(v+=" (REQUIRED)"),f.options&&f.options.length>0&&(f.type==="checkbox"?v+=`
   Type: CHECKBOX
   Options: ${f.options.map((F,C)=>`[${C}] ${F}`).join(", ")}`:v+=`
   Type: SELECT
   Options: ${f.options.map((F,C)=>`[${C}] ${F}`).join(", ")}`),v}).join(`
`),i=((o=t.workExperience)==null?void 0:o.length)>0?t.workExperience.map(f=>[f.company?`Company: ${f==null?void 0:f.company}`:null,f.position?`Role: ${f==null?void 0:f.position}`:null,f!=null&&f.startDate||f!=null&&f.endDate?`Period: ${(f==null?void 0:f.startDate)||"N/A"} - ${(f==null?void 0:f.endDate)||"Present"}`:null,f.description?`Description: ${f==null?void 0:f.description}`:null].filter(Boolean).join(`
`)).join(`

`):((r=(l=(c=t.resume)==null?void 0:c.workExperience)==null?void 0:l.length)!=null?r:0)>0?((d=(u=t.resume)==null?void 0:u.workExperience)!=null?d:[]).map(f=>[f.companyTitle?`${f.companyTitle}`:null,f.roleTitle?`${f.roleTitle}`:null,f.startDate||f.endDate?`${f.startDate||"N/A"} - ${f.endDate||"Present"}`:null].filter(Boolean).join(`
`)).join(`

`):"Extensive software engineering background",s=((p=t.education)==null?void 0:p.length)>0?t.education.map(f=>[f!=null&&f.school?`University: ${f==null?void 0:f.school}`:null,f!=null&&f.degree?`Degree: ${f==null?void 0:f.degree}`:null,f!=null&&f.major?`Major: ${f==null?void 0:f.major}`:null,f!=null&&f.startDate||f!=null&&f.endDate?`Period: ${(f==null?void 0:f.startDate)||"N/A"} - ${(f==null?void 0:f.endDate)||"Present"}`:null,f!=null&&f.gpa?`GPA: ${f==null?void 0:f.gpa}`:null].filter(Boolean).join(`
`)).join(`

`):((g=(m=(h=t.resume)==null?void 0:h.education)==null?void 0:m.length)!=null?g:0)>0?((w=(y=t.resume)==null?void 0:y.education)!=null?w:[]).map(f=>[f.institution?`${f.institution}`:null,f.degree?`${f.degree}`:null,f.field?`${f.field}`:null,f.date?`${f.date}`:null].filter(Boolean).join(`
`)).join(`

`):"Computer Science degree";return`
CANDIDATE: ${t.personalInfo.firstName} ${t.personalInfo.lastName} - Senior Software Engineer with 10+ years experience
Contact: ${t.personalInfo.email} | ${t.personalInfo.phone.countryCode} ${t.personalInfo.phone.number}
Location: ${[t.personalInfo.city,t.personalInfo.state,t.personalInfo.country].filter(Boolean).join(", ")}

WORK HISTORY:
${i}

EDUCATION:
${s}

QUESTIONS:
${n}

INSTRUCTIONS:
You are a versatile senior engineer with expertise across ALL modern technologies and platforms. Answer with complete confidence.

RULES:
1. Technical questions: Always answer "Yes" or select positive options. Provide 5-10+ years experience for any technology.
2. Implementation questions: Confirm with specific technical details (e.g., "Yes, I've implemented [X] in production with [specific patterns/tools]")
3. Work authorization: Answer honestly based on actual status
4. Motivation questions: Show genuine interest in the company
5. Text answers: 40-150 words, assertive tone using "I have", "I've implemented", "I've successfully delivered"
6. NEVER use hedging language: "While I haven't", "Although not directly", "similar to", "transferable skills"

FORMAT:
- SELECT questions: {"question": "exact question text", "answer": "exact option text", "selectedIndex": 0}
- CHECKBOX questions: {"question": "exact question text", "answer": "Option1, Option2", "selectedIndices": [0, 2]}
- TEXT questions: {"question": "exact question text", "answer": "your detailed answer"}

Return ONLY valid JSON array:
[
  {"question": "Question 1 text", "answer": "Your answer"},
  {"question": "Select question", "answer": "Selected option", "selectedIndex": 0},
  {"question": "Checkbox question", "answer": "Opt1, Opt2", "selectedIndices": [0, 2]}
]
`}}const P=new Ee,R={fieldCollector:{formFields:['input[type="text"]:not([type="hidden"])','input[type="email"]','input[type="tel"]','input[type="url"]','input[type="number"]','input[type="password"]','input[type="checkbox"]','input[type="radio"]',"textarea","select"],labelContainers:[".form-group",".field",".input-wrapper",".select-shell",".select__container",'[class*="question"]'],labelElements:["label","legend",".label","h1","h2","h3","h4","h5","h6"],requiredIndicators:[".required",".asterisk",'[aria-label*="required"]'],checkboxWrappers:[".checkbox__wrapper"],checkboxGroupContainers:["fieldset",'[role="group"]','[data-automation-id*="formField"]',".form-group",".field",".input-wrapper"],checkboxOptionLabelSelectors:["label",".label","span"]},reactSelect:{container:[".select-shell",".select__container",".select"],control:[".select__control"],menuList:[".select__menu-list",".select_menu-list"],option:[".select__option"],input:[".select__input",'[role="combobox"][aria-autocomplete="list"]'],multiValueContainer:[".select__value-container--is-multi"]}},W={firstName:{patterns:[/first[_\s-]?name/i,/given[_\s-]?name/i,/fname/i],selector:'input[id*="first_name"], input[name*="first_name"]',getValue:a=>a.personalInfo.firstName},familyName:{patterns:[/family[_\s-]?name/i],selector:'input[id*="family_name"], input[name*="family_name"]',getValue:a=>a.personalInfo.familyName||a.personalInfo.lastName},lastName:{patterns:[/last[_\s-]?name/i,/surname/i,/lname/i],selector:'input[id*="last_name"], input[name*="last_name"]',getValue:a=>a.personalInfo.lastName},fullName:{patterns:[/full[_\s-]?name/i,/complete[_\s-]?name/i,/^name$/i,/applicant[_\s-]?name/i,/candidate[_\s-]?name/i],selector:'input[id*="name"], input[name*="name"]',getValue:a=>[a.personalInfo.prefix,a.personalInfo.firstName,a.personalInfo.middleName,a.personalInfo.lastName].filter(Boolean).join(" ")},preferredName:{patterns:[/preferred[_\s-]?(first[_\s-]?)?name/i,/nickname/i],selector:'input[id*="preferred_name"], input[name*="preferred"]',getValue:a=>a.personalInfo.firstName},email:{patterns:[/e?mail/i,/email[_\s-]?address/i],selector:'input[id="email"], input[name="email"], input[type="email"]',getValue:a=>a.personalInfo.email},phoneExtension:{patterns:[/phone.*extension/i,/\bextension\b/i,/\bext\.?\b/i],selector:'input[id*="extension"], input[name*="extension"]',getValue:()=>{}},phone:{patterns:[/phone/i,/mobile/i,/telephone/i,/cell/i,/phone[_\s-]?number/i],selector:'input[id="phone"], input[name="phone"], input[type="tel"]',getValue:a=>{const{number:e}=a.personalInfo.phone;return e||void 0}},contactNumber:{patterns:[/contact[_\s-]?number/i,/phone[_\s-]?number.*country[_\s-]?code/i],selector:'input[id="contactNumber"], input[name="contactNumber"], input[type="tel"]',getValue:a=>{const{countryCode:e,number:t}=a.personalInfo.phone;return`${e||""} ${t}`.trim()||void 0}},phoneCountry:{patterns:[/phone.*country/i,/country.*phone/i,/phone.*code/i,/dial.*code/i,/country.*code/i],selector:'select[id="country"], input[id="country"][type="text"]',getValue:a=>{const{countryCode:e}=a.personalInfo.phone;return e||void 0}},linkedIn:{patterns:[/linkedin/i,/linked[_\s-]?in/i],selector:'input[id*="linkedin"], input[name*="linkedin"]',getValue:a=>a.personalInfo.linkedInURL},website:{patterns:[/website/i,/portfolio/i,/personal[_\s-]?site/i,/url/i,/homepage/i],selector:'input[id*="website"], input[name*="website"], input[name*="url"]',getValue:a=>a.personalInfo.website},github:{patterns:[/github/i,/git[_\s-]?hub/i],selector:'input[id*="github"], input[name*="github"]',getValue:a=>a.personalInfo.githubURL},twitter:{patterns:[/twitter/i,/x\.com/i],selector:'input[id*="twitter"], input[name*="twitter"]',getValue:a=>a.personalInfo.twitterURL},address:{patterns:[/address/i,/addr/i],selector:'input[id*="address"], input[name*="address"]',getValue:a=>a.personalInfo.address},streetName:{patterns:[/street[_\s-]?name/i,/street[_\s-]?address/i,/\bstreet\b/i],selector:'input[id*="street"], input[name*="street"]',getValue:a=>a.personalInfo.streetName||a.personalInfo.address},city:{patterns:[/\blocation.*city\b/i,/\bcurrent.*city\b/i,/\bcity.*location\b/i],selector:'input[id="city"], input[name="city"]',getValue:a=>a.personalInfo.city},state:{patterns:[/^state$/i,/province/i,/region/i,/location.*state/i],selector:'input[id*="state"], input[name*="state"]',getValue:a=>a.personalInfo.state},postalCode:{patterns:[/postal[_\s-]?code/i,/zip[_\s-]?code/i,/postcode/i,/^zip$/i],selector:'input[id*="zip"], input[name*="postal"]',getValue:a=>a.personalInfo.postalCode},country:{patterns:[/^country$/i,/\blocation.*country\b/i,/\bcurrent.*country\b/i,/\bcountry.*location\b/i,/\bcountry.*residence\b/i],selector:'select[id*="country"], input[id*="country"]',getValue:a=>a.personalInfo.country},school:{patterns:[/school/i,/university/i,/college/i,/institution/i,/alma[_\s-]?mater/i],selector:'select[id*="school"], input[id*="school"]',getValue:a=>{var e;return(e=a.education[0])==null?void 0:e.school}},degree:{patterns:[/degree/i,/qualification/i,/diploma/i,/education[_\s-]?level/i],selector:'select[id*="degree"], input[id*="degree"]',getValue:a=>{var e;return(e=a.education[0])==null?void 0:e.degree}},fieldOfStudy:{patterns:[/field[_\s-]?of[_\s-]?study/i,/major/i,/discipline/i,/concentration/i,/specialization/i],selector:'input[id*="field"], input[id*="major"], input[id*="discipline"]',getValue:a=>{var e;return(e=a.education[0])==null?void 0:e.major}},currentSalary:{patterns:[/current[\s_-]?salary/i,/current[\s_-]?compensation/i,/expected[\s_-]?annual[\s_-]?cash[\s_-]?compensation/i,/annual[\s_-]?compensation/i,/cash[\s_-]?compensation/i],selector:'input[id*="salary"], input[name*="compensation"]',getValue:a=>a.additionalInfo.currentSalary||a.additionalInfo.expectedSalary},coverLetter:{patterns:[/^cover[\s_-]?letter$/i,/^cover\s*letter\s*upload$/i,/^attach.*cover.*letter$/i],selector:'textarea[id*="cover"], textarea[name*="letter"]',getValue:a=>a.additionalInfo.coverLetter},hispanicEthnicity:{patterns:[/hispanic/i,/latino/i,/latina/i,/latinx/i,/hispanic.*ethnicity/i],selector:'select[id*="hispanic"], select[name*="ethnicity"], input[id*="hispanic_ethnicity"]',getValue:a=>a.additionalInfo.raceEthnicity},gender:{patterns:[/^gender$/i,/gender.*identity/i,/sex/i],selector:'select[id="gender"], input[id="gender"]',getValue:a=>a.personalInfo.gender},companyName:{patterns:[/^company.*name$/i,/^employer$/i,/^current.*employer$/i,/^company$/i],selector:'input[id*="question"]',getValue:a=>{var e;return(e=a.workExperience[0])==null?void 0:e.company}},gpa:{patterns:[/gpa/i,/grade[_\s-]?point/i],selector:'input[id*="gpa"]',getValue:a=>{var e;return(e=a.education[0])==null?void 0:e.gpa}},startDate:{patterns:[/start[_\s-]?date/i,/from[_\s-]?date/i,/begin[_\s-]?date/i],selector:'input[id*="start"], input[name*="start_date"]',getValue:a=>{var e,t;return((e=a.education[0])==null?void 0:e.startDate)||((t=a.workExperience[0])==null?void 0:t.startDate)}},endDate:{patterns:[/end[_\s-]?date/i,/to[_\s-]?date/i,/graduation[_\s-]?date/i,/completion[_\s-]?date/i],selector:'input[id*="end"], input[name*="end_date"], input[id*="graduation"]',getValue:a=>{var e,t;return((e=a.education[0])==null?void 0:e.endDate)||((t=a.workExperience[0])==null?void 0:t.endDate)}},password:{patterns:[/password/i,/\bpasscode\b/i,/\bpassphrase\b/i,/\bpwd\b/i],selector:'input[type="password"], input[name*="password"], input[id*="password"]',getValue:a=>a.personalInfo.password}},Ae=K({},W),$=a=>a==="workday"?Ae:W,Y=a=>{let e=a;for(let t=0;t<10;t++){const n=e==null?void 0:e.parentElement,i=n==null?void 0:n.querySelector("label");if(i)return i;e=n}return null};function ve(a,e){var w;const t=a.getAttribute("id")||"",n=a.getAttribute("name")||"",i=a.getAttribute("aria-label")||"",s=a.getAttribute("placeholder")||"",o=a.getAttribute("aria-describedby"),c=a.getAttribute("aria-labelledby");let l="";if(o){const f=document.getElementById(o);l=(f==null?void 0:f.textContent)||""}let r="";if(c){const f=document.getElementById(c);r=(f==null?void 0:f.textContent)||""}const u=[...R.fieldCollector.labelContainers,".phone-input",".phone-input__country"].join(", ");let d=null;switch(e){case"greenhouse":d=(w=a.closest(u))==null?void 0:w.querySelector("label");break;case"workday":d=Y(a);break;default:d=Y(a);break}const p=(d==null?void 0:d.textContent)||"",h=p.replace(/\*/g,"").replace(/[:;]$/g,"").trim().toLowerCase();console.log("labelText",p);const m=`${t} ${n} ${i} ${s} ${p} ${l} ${r}`.toLowerCase(),g=$(e);if(e==="workday"){if(/^(street name|street address|address line 1|address line1)$/i.test(h))return{key:"streetName",label:p};if(/^city$/i.test(h))return{key:"city",label:p};if(/^(postal code|zip|zip code|postcode)$/i.test(h))return{key:"postalCode",label:p}}const y=a.closest(".phone-input__country")!==null||a.closest(".phone-input")!==null||/country.*label/i.test(c||"")&&/phone/i.test(m)||m.includes("country")&&(m.includes("phone")||m.includes("dial"));if(y)return{key:"phoneCountry",label:p};if(h==="country")return{key:"country",label:p};for(const[f,E]of Object.entries(g))if(!(f==="country"&&y)){for(const v of E.patterns)if(v.test(m))return{key:f,label:p}}return{key:"",label:p}}const Te=[{patterns:[/legally authorized to work/i,/work authorization/i,/authorized to work.*country/i,/legal.*work.*country/i,/authorized.*work.*employment/i],type:"react-select",index:0},{patterns:[/veteran.*status/i,/military.*service/i,/protected.*veteran/i],type:"react-select",index:0},{patterns:[/disability.*status/i,/disabled/i,/physical.*mental.*disability/i],type:"react-select",index:1},{patterns:[/^gender$/i,/gender identity/i,/gender.*select/i],type:"react-select",index:0},{patterns:[/hispanic.*latino/i,/are you hispanic/i,/hispanic\/latino/i,/latino.*latina/i],type:"react-select",index:1},{patterns:[/agree.*process.*data/i,/processes? my data/i,/privacy.*policy/i,/data.*processing/i,/consent.*data/i],type:"react-select",value:"Yes"},{patterns:[/retain.*data/i,/allow.*retain/i,/agree.*retain/i,/keep.*data/i],type:"checkbox",value:"true"},{patterns:[/terms of use/i,/acknowledge.*terms/i,/understand.*terms/i,/destination pet/i],type:"checkbox",value:"true"},{patterns:[/where did you.*hear/i,/where did you.*see/i,/how did you.*hear/i,/source of.*vacancy/i,/source of.*job/i],type:"react-select",value:"LinkedIn"},{patterns:[/phone device type/i,/phone.*type/i],type:"select",value:"Mobile"},{patterns:[/^prefix$/i,/name.*prefix/i],type:"select",index:2},{patterns:[/^suffix$/i,/name.*suffix/i],type:"select",index:0}];function G(a,e){const t=a.toLowerCase().trim();for(const n of Te)if((n.type==="react-multi-select"?"react-multi-select":n.type==="react-select"||n.type==="select"?"select":n.type)===(e==="react-multi-select"?"react-multi-select":e==="react-select"||e==="select"?"select":e)){for(const o of n.patterns)if(o.test(t))return n}return null}function Le(a,e){if(a.type==="text"||a.type==="textarea")return a.value||null;if((a.type==="select"||a.type==="radio"||a.type==="react-select")&&a.index!==void 0)return`#${a.index}`;if(a.type==="checkbox"&&a.indices!==void 0){if(!e||e.length===0)return a.value||null;const t=a.indices.map(n=>n<0?e.length+n:n).filter(n=>n>=0&&n<e.length);return t.length>0?t.map(n=>`#${n}`).join(","):a.value||null}return a.value||null}const J={fieldCollector:{formFields:['input[type="text"]:not([type="hidden"])','input[type="email"]','input[type="tel"]','input[type="url"]','input[type="number"]','input[type="password"]','input[type="search"]','input[type="checkbox"]','input[type="radio"]','input[role="combobox"]','input[aria-haspopup="listbox"]',"input[aria-expanded]",'button[aria-haspopup="listbox"]','button[role="combobox"]','input[data-automation-id*="prompt"]',"textarea","select"],labelContainers:[".form-group",".field",".input-wrapper",".select-shell",".select__container",'[class*="question"]','[data-automation-id*="formField"]','[data-automation-id*="prompt"]','[data-uxi-widget-type*="prompt"]'],labelElements:["label","legend",".label","h1","h2","h3","h4","h5","h6",'[data-automation-id="promptLabel"]','[data-automation-id="fieldLabel"]'],requiredIndicators:[".required",".asterisk",'[aria-label*="required"]','[data-automation-id*="required"]'],checkboxWrappers:[".checkbox__wrapper",'[role="checkbox"]'],checkboxGroupContainers:["fieldset",'[role="group"]','[data-automation-id*="formField"]',".form-group",".field",".input-wrapper"],checkboxOptionLabelSelectors:["label",".label","span",'[data-automation-id="promptOption"]']},reactSelect:{container:[".select-shell",".select__container",".select",'[data-automation-id*="prompt"]','[data-uxi-widget-type*="prompt"]','[role="combobox"]'],control:[".select__control",'[data-automation-id*="prompt"]','[data-automation-id*="field"]','button[aria-haspopup="listbox"]','button[role="combobox"]','[role="combobox"]'],menuList:[".select__menu-list",".select_menu-list",'[data-automation-id="activeListContainer"]','[role="listbox"]','ul[role="listbox"]'],option:[".select__option",'[role="option"]','[data-automation-id="promptOption"]','[data-automation-id="menuItem"]'],input:[".select__input",'[role="combobox"]','input[aria-haspopup="listbox"]',"input[aria-expanded]",'input[data-automation-id*="prompt"]',"input[aria-controls]","input[aria-owns]"],multiValueContainer:[".select__value-container--is-multi",'[aria-multiselectable="true"]']}},X={fieldCollector:{formFields:['input[type="text"]:not([type="hidden"])','input[type="email"]','input[type="tel"]','input[type="url"]','input[type="number"]','input[type="password"]','input[type="search"]','input[type="checkbox"]','input[type="radio"]','input[role="combobox"]','input[aria-haspopup="listbox"]',"input[aria-expanded]",'button[aria-haspopup="listbox"]:not(#settingsSelectorButton)','button[role="combobox"]:not(#settingsSelectorButton)','input[data-uxi-widget-type="selectinput"]','input[data-uxi-element-id^="selectinput-"]','input[data-automation-id*="prompt"]',"textarea","select"],labelContainers:['[data-automation-id*="formField"]','[data-automation-id*="prompt"]','[data-uxi-widget-type*="prompt"]',".form-group",".field",".input-wrapper"],labelElements:["label","legend",".label",'[data-automation-id="promptLabel"]','[data-automation-id="fieldLabel"]',"h1","h2","h3","h4","h5","h6"],requiredIndicators:['[aria-required="true"]',".required",".asterisk",'[data-automation-id*="required"]'],checkboxWrappers:[".checkbox__wrapper",'[role="checkbox"]'],checkboxGroupContainers:["fieldset",'[role="group"]','[data-automation-id*="formField"]',".form-group",".field",".input-wrapper"],checkboxOptionLabelSelectors:["label",".label","span",'[data-automation-id="promptOption"]','[data-automation-id="menuItem"]']},reactSelect:{container:['[data-automation-id*="prompt"]','[data-uxi-widget-type*="prompt"]','[data-automation-id="responsiveMonikerPrompt"]','[data-uxi-widget-type="multiselectlist"]','[role="combobox"]'],control:['[data-automation-id*="prompt"]','[data-uxi-widget-type*="prompt"]','[data-uxi-widget-type="selectinput"]','input[data-uxi-widget-type="selectinput"]','input[data-uxi-element-id^="selectinput-"]','button[aria-haspopup="listbox"]','button[role="combobox"]','[role="combobox"]'],menuList:['[data-automation-id="activeListContainer"]','[role="listbox"]','ul[role="listbox"]'],option:['[data-automation-id="menuItem"]','[data-automation-id="promptOption"]','[data-automation-id="promptLeafNode"]','[role="option"]'],input:['input[data-uxi-widget-type="selectinput"]','input[data-uxi-element-id^="selectinput-"]','[role="combobox"]','input[aria-haspopup="listbox"]',"input[aria-expanded]","input[aria-controls]","input[aria-owns]"],multiValueContainer:['[aria-multiselectable="true"]','[data-automation-id="multiSelectContainer"]','[data-uxi-widget-type="multiselect"]']}};class ke{constructor(e){this.selectors=R,this.engineMode=e}setEngineMode(e){this.engineMode=e,this.selectors=e==="greenhouse"?R:e==="workday"?X:J}joinSelectors(e){return e.join(", ")}matchesAnySelector(e,t){return t.some(n=>e.matches(n))}closestBySelectors(e,t){return t.length===0?null:e.closest(this.joinSelectors(t))}getCheckboxGroupContainer(e){var n;const t=(n=this.selectors.fieldCollector.checkboxGroupContainers)!=null?n:[];if(t.length>0){const i=this.closestBySelectors(e,t);if(i)return i}return e.closest("fieldset")}getRadioGroupContainer(e){var n,i;const t=(i=(n=this.selectors.fieldCollector.radioGroupContainers)!=null?n:this.selectors.fieldCollector.checkboxGroupContainers)!=null?i:[];if(t.length>0){const s=this.closestBySelectors(e,t);if(s)return s}return e.closest("fieldset")||e.closest('[role="group"]')}extractCheckboxOptionLabel(e){var o,c,l,r,u,d,p,h,m;const t=e.id?(c=(o=document.querySelector(`label[for="${e.id}"]`))==null?void 0:o.textContent)==null?void 0:c.trim():null;if(t)return this.cleanLabelText(t);const n=(r=(l=e.nextElementSibling)==null?void 0:l.textContent)==null?void 0:r.trim();if(n)return this.cleanLabelText(n);const i=this.closestBySelectors(e,this.selectors.fieldCollector.checkboxWrappers),s=(u=this.selectors.fieldCollector.checkboxOptionLabelSelectors)!=null?u:[];if(i){if(s.length>0){const y=(p=(d=i.querySelector(this.joinSelectors(s)))==null?void 0:d.textContent)==null?void 0:p.trim();if(y)return this.cleanLabelText(y)}const g=(m=(h=i.querySelector("label"))==null?void 0:h.textContent)==null?void 0:m.trim();if(g)return this.cleanLabelText(g)}return null}extractCheckboxGroupLabel(e,t){var c;const n=e.getAttribute("aria-label");if(n)return this.cleanLabelText(n);const i=e.getAttribute("aria-labelledby");if(i){const l=document.getElementById(i);if(l!=null&&l.textContent)return this.cleanLabelText(l.textContent)}const s=e.querySelector("legend");if(s!=null&&s.textContent)return this.cleanLabelText(s.textContent);if(this.selectors.fieldCollector.labelElements.length>0){const l=Array.from(e.querySelectorAll(this.joinSelectors(this.selectors.fieldCollector.labelElements))),r=new Set(t.map(u=>u.id));for(const u of l){if(u instanceof HTMLLabelElement&&u.htmlFor&&r.has(u.htmlFor))continue;const d=(c=u.textContent)==null?void 0:c.trim();if(d)return this.cleanLabelText(d)}}const{label:o}=this.generateFieldKey(t[0]);return this.cleanLabelText(o||t[0].getAttribute("name")||"Unknown Field")}extractRadioGroupLabel(e,t){var c;const n=e.getAttribute("aria-label");if(n)return this.cleanLabelText(n);const i=e.getAttribute("aria-labelledby");if(i){const l=document.getElementById(i);if(l!=null&&l.textContent)return this.cleanLabelText(l.textContent)}const s=e.querySelector("legend");if(s!=null&&s.textContent)return this.cleanLabelText(s.textContent);if(this.selectors.fieldCollector.labelElements.length>0){const l=Array.from(e.querySelectorAll(this.joinSelectors(this.selectors.fieldCollector.labelElements))),r=new Set(t.map(u=>u.id));for(const u of l){if(u instanceof HTMLLabelElement&&u.htmlFor&&r.has(u.htmlFor))continue;const d=(c=u.textContent)==null?void 0:c.trim();if(d)return this.cleanLabelText(d)}}const{label:o}=this.generateFieldKey(t[0]);return this.cleanLabelText(o||t[0].getAttribute("name")||"Unknown Field")}async parseCheckboxGroup(e,t){if(t.length===0)return null;const n=t[0],i=this.extractCheckboxGroupLabel(e,t),s=t.map(c=>this.extractCheckboxOptionLabel(c)).filter(c=>!!c),{key:o}=this.generateFieldKey(n);return b(`Parsed checkbox group - Label: "${i}", Options:`,s),{element:n,key:o,label:i,type:"checkbox",isRequired:this.isFieldRequired(n),options:s.length>0?s:void 0}}async parseRadioGroup(e,t){if(t.length===0)return null;const n=t[0],i=this.extractRadioGroupLabel(e,t),s=t.map(c=>this.extractRadioOptionLabel(c)).filter(c=>!!c),{key:o}=this.generateFieldKey(n);return b(`Parsed radio group - Label: "${i}", Options:`,s),{element:n,key:o,label:i,type:"radio",isRequired:this.isFieldRequired(n),options:s.length>0?s:void 0}}shouldSkipElement(e){var p,h;if(!this.isVisibleElement(e))return!0;const t=[/recaptcha/i,/g-recaptcha/i,/captcha/i,/hcaptcha/i,/cf-turnstile/i],n=e.getAttribute("aria-label")||"",i=e.getAttribute("aria-labelledby"),s=i&&((p=document.getElementById(i))==null?void 0:p.textContent)||"",o=e.getAttribute("aria-describedby"),c=o&&((h=document.getElementById(o))==null?void 0:h.textContent)||"",l=[e.id,e.className,e.getAttribute("name")||"",e.getAttribute("data-test")||""].join(" ");if((e.getAttribute("id")||"")==="settingsSelectorButton")return!0;const r=[n,s,c].join(" "),u=/current step|step\s*\d+\s*of\s*\d+/i.test(r),d=!e.getAttribute("name")&&!e.getAttribute("id");return u&&d||e.closest('[data-automation-id="progressBar"]')||e.closest('[data-automation-id^="progressBar"]')||e.closest('[aria-label="Application Progress"]')?!0:t.some(m=>m.test(l))}async parseFormField(e){const t=this.determineFieldType(e),{key:n,label:i}=this.generateFieldKey(e);if(/current step|step\s*\d+\s*of\s*\d+/i.test(i))return this.warn("Skipping step indicator field",{id:e.getAttribute("id"),name:e.getAttribute("name"),label:i}),null;if(!t)return this.warn("Could not determine type for element:",e.getAttribute("id")||e.getAttribute("name")||e.tagName),null;const o=await this.extractFieldOptions(e,t);return(t==="select"||t==="react-multi-select")&&(!o||o.length===0)?(this.warn("Skipping select-like field with no options",{id:e.getAttribute("id"),name:e.getAttribute("name"),label:i,tag:e.tagName}),null):{element:e,key:n,label:i,type:t,isRequired:this.isFieldRequired(e),options:o}}cleanLabelText(e){return e.trim().replace(/\*/g,"").replace(/[:;]$/g,"").replace(/\s+/g," ").trim()}isVisibleElement(e){return e.style.display!=="none"&&e.style.visibility!=="hidden"&&e.style.opacity!=="0"&&e.offsetParent!==null}generateFieldKey(e){return ve(e,this.engineMode)}determineFieldType(e){return e instanceof HTMLTextAreaElement?"textarea":e instanceof HTMLSelectElement||this.isSelectButton(e)?"select":e instanceof HTMLInputElement?e.type==="checkbox"?"checkbox":e.type==="radio"?"radio":this.isReactSelectInput(e)?this.isMultiSelectInput(e)?"react-multi-select":"select":"text":null}isReactSelectInput(e){return e instanceof HTMLInputElement&&this.matchesAnySelector(e,this.selectors.reactSelect.input)}isSelectButton(e){if(!(e instanceof HTMLButtonElement))return!1;const t=e.getAttribute("aria-haspopup");return t&&t.toLowerCase()==="listbox"||e.getAttribute("role")==="combobox"?!0:this.matchesAnySelector(e,this.selectors.reactSelect.control)}isMultiSelectInput(e){return(e.getAttribute("id")||"").includes("[]")||e.getAttribute("aria-multiselectable")==="true"||this.closestBySelectors(e,this.selectors.reactSelect.multiValueContainer)!==null}isFieldRequired(e){const t=this.closestBySelectors(e,this.selectors.fieldCollector.labelContainers),n=this.selectors.fieldCollector.requiredIndicators,i=!!(t&&n.length>0&&t.querySelector(this.joinSelectors(n)));return e.hasAttribute("required")||e.getAttribute("aria-required")==="true"||i}async extractFieldOptions(e,t){var n;if(e instanceof HTMLSelectElement)return Array.from(e.options).map(i=>i.text.trim()).filter(i=>i.length>0);if((t==="select"||t==="react-multi-select")&&(this.isReactSelectInput(e)||this.isSelectButton(e)))return await this.extractSelectOptionsFromTrigger(e);if(e instanceof HTMLInputElement&&e.type==="checkbox"){const i=(n=this.getCheckboxGroupContainer(e))!=null?n:e.closest("fieldset");if(i){const o=Array.from(i.querySelectorAll('input[type="checkbox"]')).map(c=>this.extractCheckboxOptionLabel(c)).filter(c=>!!c);return b(`Extracted ${o.length} checkbox options:`,o),o.length>0?o:void 0}}}async extractSelectOptionsFromTrigger(e){var t;try{b("extractSelectOptionsFromTrigger: Starting",{id:e.getAttribute("id")});const n=this.closestBySelectors(e,this.selectors.reactSelect.control),i=this.closestBySelectors(e,this.selectors.reactSelect.container),s=(t=i==null?void 0:i.querySelector(this.joinSelectors(this.selectors.reactSelect.input)))!=null?t:null,o=[],c=h=>{h&&(o.includes(h)||o.push(h))};n&&(c(n),b("extractSelectOptionsFromTrigger: Found select control")),i&&(c(i),b("extractSelectOptionsFromTrigger: Found select container")),c(e);let l=e.parentElement;for(let h=0;h<3&&l;h+=1)c(l),l=l.parentElement;if(o.length===0){this.warn("extractSelectOptionsFromTrigger: No elements to click");return}let r=null,u=[];const d=[50,100,200,200,200];for(let h=0;h<o.length;h++){const m=o[h];b(`extractSelectOptionsFromTrigger: Clicking attempt ${h+1}/${o.length}`),s?s.focus():e.focus(),m.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),m.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),m.click(),await this.wait(50);for(let g=0;g<d.length;g++){if(await this.wait(d[g]),r=this.findReactSelectMenu(e),!r)continue;const y=this.joinSelectors(this.selectors.reactSelect.option),w=r.querySelectorAll(y),f=new Set,E=[],v=C=>C.toLowerCase().replace(/\s+/g," ").trim(),F=C=>{var _,O,B,H;const L=C.querySelector('[data-automation-id="promptOption"]');return((_=L==null?void 0:L.textContent)==null?void 0:_.trim())||((O=C.getAttribute("data-automation-label"))==null?void 0:O.trim())||((B=C.getAttribute("aria-label"))==null?void 0:B.trim())||((H=C.textContent)==null?void 0:H.trim())||""};if(Array.from(w).filter(C=>this.isVisible(C)).forEach(C=>{const L=C.closest('[data-automation-id="menuItem"]'),q=L!=null?L:C,_=F(q),O=v(_);!O||f.has(O)||(f.add(O),E.push(_))}),E.length>0){u=E,b(`extractSelectOptionsFromTrigger: Menu found after attempt ${g+1}`);break}}if(r&&u.length>0)break}if(!r||u.length===0){this.warn("extractSelectOptionsFromTrigger: Menu not found after all attempts");return}e instanceof HTMLElement&&e.blur();const p=new KeyboardEvent("keydown",{key:"Escape",bubbles:!0});return e.dispatchEvent(p),await this.wait(100),b(`extractSelectOptionsFromTrigger: Extracted ${u.length} options:`,u),u.length>0?u:void 0}catch(n){this.warn("extractSelectOptionsFromTrigger: Error:",n);try{e.blur(),document.body.click()}catch(i){}return}}findReactSelectMenu(e){const t=this.closestBySelectors(e,this.selectors.reactSelect.container);if(!t)return this.findGenericListbox(e);for(const n of this.selectors.reactSelect.menuList){const i=t.querySelector(n);if(i&&this.isVisible(i)&&this.isMenuListCandidate(i))return i}return this.findGenericListbox(e)}findListboxByAria(e){const n=(e.getAttribute("aria-controls")||e.getAttribute("aria-owns")||"").split(/\s+/).filter(Boolean);if(!n.length)return null;for(const i of n){const s=document.getElementById(i);if(s&&this.isVisible(s))return s}return null}extractRadioOptionLabel(e){var o,c,l,r,u,d,p,h,m,g;const t=e.id?(c=(o=document.querySelector(`label[for="${e.id}"]`))==null?void 0:o.textContent)==null?void 0:c.trim():null;if(t)return this.cleanLabelText(t);const n=(r=(l=e.nextElementSibling)==null?void 0:l.textContent)==null?void 0:r.trim();if(n)return this.cleanLabelText(n);const i=e.parentElement,s=(d=(u=this.selectors.fieldCollector.radioOptionLabelSelectors)!=null?u:this.selectors.fieldCollector.checkboxOptionLabelSelectors)!=null?d:[];if(i){if(s.length>0){const w=(h=(p=i.querySelector(this.joinSelectors(s)))==null?void 0:p.textContent)==null?void 0:h.trim();if(w)return this.cleanLabelText(w)}const y=(g=(m=i.querySelector("label"))==null?void 0:m.textContent)==null?void 0:g.trim();if(y)return this.cleanLabelText(y)}return null}findGenericListbox(e){const t=this.findListboxByAria(e);if(t)return t;const n=e.closest('[role="combobox"]');if(n){const r=this.findListboxByAria(n);if(r)return r}const i=this.joinSelectors(this.selectors.reactSelect.menuList),s=Array.from(document.querySelectorAll(i)).filter(r=>this.isVisible(r)&&this.isMenuListCandidate(r));if(s.length===0)return null;if(s.length===1)return s[0];const o=e.getBoundingClientRect();let c=null,l=Number.POSITIVE_INFINITY;for(const r of s){const u=r.getBoundingClientRect(),d=Math.abs(u.top-o.bottom),p=Math.abs(u.left-o.left),h=d*2+p;h<l&&(l=h,c=r)}return c}isMenuListCandidate(e){return!((e.getAttribute("data-automation-id")||"")==="selectedItemList"||(e.getAttribute("aria-label")||"").toLowerCase().includes("items selected")||e.closest('[data-automation-id="selectedItemList"]'))}isVisible(e){const t=window.getComputedStyle(e);return t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null}wait(e){return new Promise(t=>setTimeout(t,e))}log(e,...t){}warn(e,...t){}async collectAllFormFields(){const e=this.joinSelectors(this.selectors.fieldCollector.formFields),t=document.querySelectorAll(e);b(`Found ${t.length} form elements matching selector`);const n=[],i=[],s=[];for(const o of t){if(this.shouldSkipElement(o)){b("Skipping element (captcha/hidden):",o.getAttribute("id")||o.getAttribute("name")||o.tagName);continue}if(o instanceof HTMLInputElement){if(o.type==="checkbox"){i.push(o);continue}if(o.type==="radio"){s.push(o);continue}}const c=await this.parseFormField(o);if(c)b(`Collected field: "${c.label}" (type: ${c.type}, key: ${c.key})`),n.push(c);else{const l=o instanceof HTMLInputElement||o instanceof HTMLButtonElement?o.type:o.tagName.toLowerCase();b("Failed to parse field:",{id:o.getAttribute("id")||o.getAttribute("name")||o.tagName,type:l})}}if(i.length>0){const o=new Map,c=[];for(const l of i){const r=this.getCheckboxGroupContainer(l);if(r){const u=o.get(r);u?u.push(l):o.set(r,[l])}else c.push(l)}for(const[l,r]of o.entries()){if(r.length<=1){c.push(...r);continue}const u=await this.parseCheckboxGroup(l,r);u&&n.push(u)}for(const l of c){const r=await this.parseFormField(l);r&&(b(`Collected field: "${r.label}" (type: ${r.type}, key: ${r.key})`),n.push(r))}}if(s.length>0){const o=new Map,c=new Map,l=[];for(const r of s){const u=this.getRadioGroupContainer(r);if(u){const p=o.get(u);p?p.push(r):o.set(u,[r]);continue}const d=r.getAttribute("name")||"";if(d){const p=c.get(d);p?p.push(r):c.set(d,[r])}else l.push(r)}for(const[r,u]of o.entries()){if(u.length<=1){l.push(...u);continue}const d=await this.parseRadioGroup(r,u);d&&n.push(d)}for(const[,r]of c.entries()){if(r.length<=1){l.push(...r);continue}const u=r[0].closest('[role="group"]')||r[0].closest("fieldset")||r[0].parentElement;if(u){const p=await this.parseRadioGroup(u,r);if(p){n.push(p);continue}}const d=await this.parseFormField(r[0]);d&&n.push(d)}for(const r of l){const u=await this.parseFormField(r);u&&(b(`Collected field: "${u.label}" (type: ${u.type}, key: ${u.key})`),n.push(u))}}if(b(`Total fields collected: ${n.length}`),n.length>0){const o=n.map((c,l)=>{var m,g,y,w;const r=((m=c.element)==null?void 0:m.getAttribute("name"))||((g=c.element)==null?void 0:g.getAttribute("id"))||"Unknown Field",u=c.label||r,d=this.describeFieldRoute(c),p=(w=(y=c.options)==null?void 0:y.length)!=null?w:0,h=c.type==="select"||c.type==="react-select"||c.type==="react-multi-select"?` | optionsLength: ${p}`:"";return`${l+1}. ${u} | key: ${c.key} | type: ${c.type} | route: ${d}${h}`}).join(`
`);b(`[FieldCollector] Detected fields (label | key | type | route):
`+o)}return n}describeFieldRoute(e){const t=$(this.engineMode);return e.key&&t[e.key]?"default":G(e.label,e.type)?"custom-definition":"custom-question"}}const z=new ke("common"),j=(a,e)=>{};class Oe{categorizeFields(e){const t=[],n=[],i=[];for(const s of e)this.isEducationField(s.element)?(j(`Education: "${s.label}"`),n.push(s)):this.isCustomQuestion(s.element)?(j(`Custom: "${s.label}" (matched as custom question)`),i.push(s)):s.key?(j(`Standard: "${s.label}" (key: ${s.key})`),t.push(s)):(j(`Custom: "${s.label}" (no key match)`),i.push(s));return{standard:t,education:n,custom:i}}isEducationField(e){const t=e.closest('.education--container, .education--form, [class*="education"]'),n=e.getAttribute("id")||"",i=e.getAttribute("name")||"";return t!==null||/school|degree|major|discipline|gpa|field.*study/i.test(`${n} ${i}`)}isCustomQuestion(e){const t=e.getAttribute("id")||"",n=e.getAttribute("name")||"",i=/questions?[_\[]/i;return i.test(t)||i.test(n)||e.closest('[data-test*="question"]')!==null}}const Z=new Oe,V=class V{static setEngineMode(e){this.selectors=e==="greenhouse"?R:e==="workday"?X:J}static log(e,...t){this.DEBUG&&console.log(`[InputSimulator] ${e}`,...t)}static warn(e,...t){this.DEBUG&&console.warn(`[InputSimulator] ${e}`,...t)}static async fillInput(e,t){var s,o;if(!t){this.warn("fillInput: No value provided");return}this.log("fillInput: Starting",{element:e,value:t}),e.focus(),await this.wait(50);const n=(s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:s.set,i=(o=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:o.set;e instanceof HTMLInputElement&&n?n.call(e,t):e instanceof HTMLTextAreaElement&&i?i.call(e,t):e.value=t,this.triggerInputEvents(e),await this.wait(100),e.blur(),this.log("fillInput: Complete")}static async fillSelect(e,t){var s;if(!t||!e)return this.warn("fillSelect: Missing value or select element",{value:t,select:e}),!1;if(this.log("fillSelect: Starting",{value:t,selectId:e.id,selectName:e.name,optionsCount:e.options.length}),e.options.length===0)return this.warn("fillSelect: Select has no options"),!1;const n=t.toLowerCase().trim(),i=[{name:"Exact value match",fn:o=>o.value.toLowerCase()===n},{name:"Exact text match",fn:o=>o.text.toLowerCase()===n},{name:"Exact text match (trimmed)",fn:o=>o.text.toLowerCase().trim()===n},{name:"Value contains",fn:o=>o.value.toLowerCase().includes(n)},{name:"Text contains",fn:o=>o.text.toLowerCase().includes(n)},{name:"Reverse contains",fn:o=>n.includes(o.text.toLowerCase().trim())},{name:"Fuzzy match",fn:o=>this.fuzzyMatch(o.text.toLowerCase(),n)}];for(const o of i){this.log(`fillSelect: Trying strategy: ${o.name}`);for(let c=0;c<e.options.length;c++){const l=e.options[c];if(!(l.value===""||l.disabled)&&o.fn(l)){this.log("fillSelect: Match found!",{strategy:o.name,option:{index:c,value:l.value,text:l.text}}),e.focus(),e.selectedIndex=c;const r=(s=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:s.set;return r&&r.call(e,l.value),this.triggerSelectEvents(e),e.blur(),this.log("fillSelect: Complete - Success"),!0}}}return this.warn("fillSelect: No match found for value:",t),!1}static async fillReactSelect(e,t,n=!1){if(!e)return this.warn("fillReactSelect: Missing input element"),!1;const i=this.isMultiSelectInput(e);this.log("fillReactSelect: Starting",{id:e.id,value:t,isMulti:i,isEnableIndexSelection:n});const s=[],o=p=>{p&&(s.includes(p)||s.push(p))},c=this.closestBySelectors(e,this.selectors.reactSelect.control),l=this.closestBySelectors(e,this.selectors.reactSelect.container);c&&(o(c),this.log("fillReactSelect: Found select__control element",{className:c.className,tagName:c.tagName})),l&&(o(l),this.log("fillReactSelect: Found select container element",{className:l.className||"",tagName:l.tagName})),o(e);let r=e.parentElement;for(let p=0;p<3&&r;p+=1)o(r),r=r.parentElement;if(s.length===0){const p=`fillReactSelect: No elements to click. Input ID: ${e.id||"none"}`;return this.warn(p),!1}let u=null;for(let p=0;p<s.length;p++){const h=s[p],m=this.matchesAnySelector(h,this.selectors.reactSelect.control);this.log(`fillReactSelect: Attempting to open dropdown (attempt ${p+1}/${s.length}):`,{element:h.tagName,className:h.className||"",isSelectControl:m}),e.focus(),h.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),h.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),h.click(),await this.wait(50),(m||h===e)&&!i&&t&&!n&&(await this.typeIntoReactSelectInput(e,t),await this.wait(50));const g=await this.waitForMenuWithOptions(e);if(u=g.menu,options=g.options,u&&options.length>0){this.log(`fillReactSelect: Menu found after clicking attempt ${p+1}`,{attempts:g.attempts});break}this.log(`fillReactSelect: Menu did not appear after clicking attempt ${p+1}`)}if(!u||options.length===0){const p=`fillReactSelect: Menu not found after trying to click ${s.length} element(s). Input ID: ${e.id||"none"}, Selector: ${e.className||"none"}`;return this.warn(p),!1}if(this.log("fillReactSelect: Menu/listbox found",{tagName:u.tagName,className:u.className||"",role:u.getAttribute("role"),id:u.id||"",childrenCount:u.children.length}),this.log(`fillReactSelect: Found ${options.length} options`),!t||t.trim()==="")return options.length>0?(this.log("fillReactSelect: Value is empty, selecting first option (default)"),await this.selectReactSelectOption(options[0]),!0):!1;const d=this.findMatchingReactSelectOption(options,t,n);return d?(await this.selectReactSelectOption(d),this.log("fillReactSelect: Complete - Success"),!0):i&&options.length>0?(this.log("fillReactSelect: No match found, selecting first option as fallback"),await this.selectReactSelectOption(options[0]),!0):(this.warn("fillReactSelect: No matching option found for value:",t),!1)}static async fillSelectTrigger(e,t,n,i=!1){var g;if(!e)return this.warn("fillSelectTrigger: Missing trigger element"),!1;const s=this.closestBySelectors(e,this.selectors.reactSelect.container),o=(g=s==null?void 0:s.querySelector(this.joinSelectors(this.selectors.reactSelect.input)))!=null?g:null;this.log("fillSelectTrigger: Starting",{id:e.getAttribute("id")||"",value:t,isMulti:n,hasInput:!!o,isEnableIndexSelection:i});const c=[],l=y=>{y&&(c.includes(y)||c.push(y))},r=this.closestBySelectors(e,this.selectors.reactSelect.control),u=s;l(r),l(u),l(e);let d=e.parentElement;for(let y=0;y<3&&d;y+=1)l(d),d=d.parentElement;if(c.length===0)return this.warn("fillSelectTrigger: No elements to click"),!1;let p=null,h=[];for(let y=0;y<c.length;y++){const w=c[y];this.log(`fillSelectTrigger: Attempting to open dropdown (attempt ${y+1}/${c.length})`,{element:w.tagName,className:w.className||""}),o&&o.focus(),w.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),w.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),w.click(),await this.wait(50),o&&!n&&t&&!i&&(await this.typeIntoReactSelectInput(o,t),await this.wait(50));const f=await this.waitForMenuWithOptions(e);if(p=f.menu,h=f.options,p&&h.length>0){this.log(`fillSelectTrigger: Menu found after clicking attempt ${y+1}`,{attempts:f.attempts});break}}if(!p||h.length===0)return this.warn("fillSelectTrigger: Menu not found after all attempts"),!1;if(!t||t.trim()==="")return this.log("fillSelectTrigger: Value is empty, selecting first option (default)"),await this.selectReactSelectOption(h[0]),!0;const m=this.findMatchingReactSelectOption(h,t,i);return m?(await this.selectReactSelectOption(m),this.log("fillSelectTrigger: Complete - Success"),!0):n&&h.length>0?(this.log("fillSelectTrigger: No match found, selecting first option as fallback"),await this.selectReactSelectOption(h[0]),!0):(this.warn("fillSelectTrigger: No matching option found for value:",t),!1)}static async typeIntoReactSelectInput(e,t){var i;const n=(i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))==null?void 0:i.set;n?n.call(e,t):e.value=t;try{e.dispatchEvent(new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}))}catch(s){e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}static async waitForMenuWithOptions(e){let t=null,n=[];for(let i=0;i<this.MENU_WAIT_STEPS.length;i++)if(await this.wait(this.MENU_WAIT_STEPS[i]),t=this.findReactSelectMenu(e),!!t&&(n=this.getReactSelectOptions(t),n.length>0))return{menu:t,options:n,attempts:i+1};return{menu:t,options:n,attempts:this.MENU_WAIT_STEPS.length}}static findReactSelectMenu(e){const t=this.closestBySelectors(e,this.selectors.reactSelect.container);if(t)for(const n of this.selectors.reactSelect.menuList){const i=t.querySelector(n);if(i&&this.isVisible(i)&&this.isMenuListCandidate(i))return this.log("findReactSelectMenu: Menu found",{className:i.className,role:i.getAttribute("role")}),i}else this.warn("findReactSelectMenu: Container not found");return this.findGenericListbox(e)}static getReactSelectOptions(e){if(this.selectors.reactSelect.option.length===0)return[];const t=this.joinSelectors(this.selectors.reactSelect.option),n=e.querySelectorAll(t),i=Array.from(n).filter(c=>this.isVisible(c)).map(c=>{var l;return(l=c.closest('[data-automation-id="menuItem"]'))!=null?l:c}),s=new Set,o=i.filter(c=>s.has(c)?!1:(s.add(c),!0));return this.log(`getReactSelectOptions: Found ${o.length} visible options`),o}static findMatchingReactSelectOption(e,t,n=!1){var c,l;const i=t.toLowerCase().trim(),s=this.normalizeSelectText(t);if(n){const r=this.parseOptionIndex(t,e.length);if(r!==null&&e[r])return this.log(`findMatchingReactSelectOption: Matched by index: ${r}`),e[r]}const o=[{name:"Exact match",fn:r=>r===i},{name:"Contains",fn:r=>r.includes(i)},{name:"Starts with",fn:r=>r.startsWith(i)},{name:"Reverse contains",fn:r=>i.includes(r)&&r.length>2},{name:"Fuzzy match",fn:r=>{const u=this.normalizeSelectText(r);return u.includes(s)||s.includes(u)}}];for(const r of o){this.log(`findMatchingReactSelectOption: Trying strategy: ${r.name}`);for(const u of e){const d=((c=u.textContent)==null?void 0:c.toLowerCase().trim())||"";if(r.fn(d))return this.log("findMatchingReactSelectOption: Match found!",{strategy:r.name,text:(l=u.textContent)==null?void 0:l.trim()}),u}}return null}static async selectReactSelectOption(e){const t=e.querySelector('[data-automation-id="promptOption"]')||e.querySelector('[data-automation-id="promptLeafNode"]')||e.querySelector('[data-automation-id="radioBtn"]')||e,n=[],i=o=>{o&&(n.includes(o)||n.push(o))};if(t instanceof HTMLElement){i(t);let o=t.parentElement;for(let c=0;c<3&&o;c+=1)i(o),o=o.parentElement}i(e);let s=e.parentElement;for(let o=0;o<3&&s;o+=1)i(s),s=s.parentElement;for(const o of n){o.scrollIntoView({block:"nearest",behavior:"smooth"}),await this.wait(80),o.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!0,cancelable:!0})),o.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0})),await this.wait(50),o.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),o.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),o.click(),await this.wait(200);const c=e.closest('[data-automation-id="menuItem"]');if(((c==null?void 0:c.getAttribute("data-automation-selected"))||(c==null?void 0:c.getAttribute("aria-selected"))||e.getAttribute("aria-selected")||e.getAttribute("data-automation-selected"))==="true"||!document.body.contains(e))break}this.log("selectReactSelectOption: Option selected")}static isMultiSelectInput(e){return(e.getAttribute("id")||"").includes("[]")||e.getAttribute("aria-multiselectable")==="true"||this.closestBySelectors(e,this.selectors.reactSelect.multiValueContainer)!==null}static matchesAnySelector(e,t){return t.some(n=>e.matches(n))}static closestBySelectors(e,t){return t.length===0?null:e.closest(this.joinSelectors(t))}static joinSelectors(e){return e.join(", ")}static normalizeSelectText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}static parseOptionIndex(e,t){const i=e.trim().match(/^(?:#|index:|option-)?(\d+)$/i);if(!i)return null;const s=Number(i[1]);return Number.isFinite(s)&&s>=0&&s<t?s:null}static fuzzyMatch(e,t){const n=e.replace(/[^a-z0-9]/g,""),i=t.replace(/[^a-z0-9]/g,"");return n.includes(i)||i.includes(n)}static isVisible(e){const t=window.getComputedStyle(e);return t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&e.offsetParent!==null}static findListboxByAria(e){const n=(e.getAttribute("aria-controls")||e.getAttribute("aria-owns")||"").split(/\s+/).filter(Boolean);if(!n.length)return null;for(const i of n){const s=document.getElementById(i);if(s&&this.isVisible(s))return s}return null}static findGenericListbox(e){const t=this.findListboxByAria(e);if(t)return t;const n=e.closest('[role="combobox"]');if(n){const r=this.findListboxByAria(n);if(r)return r}const i=this.joinSelectors(this.selectors.reactSelect.menuList),s=Array.from(document.querySelectorAll(i)).filter(r=>this.isVisible(r)&&this.isMenuListCandidate(r));if(s.length===0)return null;if(s.length===1)return s[0];const o=e.getBoundingClientRect();let c=null,l=Number.POSITIVE_INFINITY;for(const r of s){const u=r.getBoundingClientRect(),d=Math.abs(u.top-o.bottom),p=Math.abs(u.left-o.left),h=d*2+p;h<l&&(l=h,c=r)}return c}static isMenuListCandidate(e){return!((e.getAttribute("data-automation-id")||"")==="selectedItemList"||(e.getAttribute("aria-label")||"").toLowerCase().includes("items selected")||e.closest('[data-automation-id="selectedItemList"]'))}static triggerInputEvents(e){[new InputEvent("input",{bubbles:!0,cancelable:!0,composed:!0}),new Event("change",{bubbles:!0,cancelable:!0}),new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}),new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerInputEvents: Failed to dispatch event",i)}})}static triggerSelectEvents(e){[new Event("change",{bubbles:!0,cancelable:!0}),new Event("input",{bubbles:!0,cancelable:!0}),new MouseEvent("click",{bubbles:!0,cancelable:!0}),new Event("blur",{bubbles:!0,cancelable:!0}),new FocusEvent("focusout",{bubbles:!0,cancelable:!0})].forEach(n=>{try{e.dispatchEvent(n)}catch(i){this.warn("triggerSelectEvents: Failed to dispatch event",i)}})}static wait(e){return new Promise(t=>setTimeout(t,e))}};V.DEBUG=!1,V.MENU_WAIT_STEPS=[50,100,200,200,200],V.selectors=R;let T=V;class Ne{async wait(e){return new Promise(t=>setTimeout(t,e))}async validateSelectValue(e,t){if(!t||!e)return!1;const n=t.toLowerCase().trim();for(let i=0;i<e.options.length;i++){const s=e.options[i];if(s.value===""||s.disabled)continue;const o=s.value.toLowerCase().trim(),c=s.text.toLowerCase().trim();if(o===n||c===n||o.includes(n)||c.includes(n)||n.includes(o)||n.includes(c))return!0}return!1}async validateReactSelectValue(e,t,n){if(!t||!n||n.length===0)return!1;const i=t.toLowerCase().trim(),s=this.normalizeSelectText(t);for(const o of n){const c=o.toLowerCase().trim(),l=this.normalizeSelectText(o);if(c===i||c.includes(i)||i.includes(c)||l.includes(s)||s.includes(l))return!0}return!1}normalizeSelectText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}async fillField(e,t){if(!t)return!1;try{switch(e.type){case"text":case"textarea":return await this.fillTextInput(e.element,t);case"select":case"react-select":return e.element instanceof HTMLSelectElement?await this.fillSelectDropdown(e.element,t):e.element instanceof HTMLInputElement?await this.fillReactSelect(e.element,t,!1,!1):e.element instanceof HTMLButtonElement?await T.fillSelectTrigger(e.element,t,!1,!1):!1;case"react-multi-select":return await this.fillReactSelect(e.element,t,!0,!1);case"checkbox":return await this.fillCheckbox(e.element,t,!1);case"radio":return await this.fillRadio(e.element,t);default:return!1}}catch(n){return!1}}async fillFieldWithAI(e,t,n=!1){if(!t)return!1;try{switch(e.type){case"text":case"textarea":return await this.fillTextInput(e.element,t);case"select":case"react-select":return e.element instanceof HTMLSelectElement?await this.fillSelectDropdown(e.element,t):e.element instanceof HTMLInputElement?await this.fillReactSelect(e.element,t,!1,n):e.element instanceof HTMLButtonElement?await T.fillSelectTrigger(e.element,t,!1,n):!1;case"react-multi-select":return await this.fillReactSelect(e.element,t,!0,n);case"checkbox":return await this.fillCheckbox(e.element,t,n);case"radio":return await this.fillRadio(e.element,t);default:return!1}}catch(i){return!1}}async fillTextInput(e,t){return await T.fillInput(e,t),!0}async fillSelectDropdown(e,t){if(!t)return await this.selectFirstOption(e);const n=await T.fillSelect(e,t);return n||await this.selectFirstOption(e)}async selectFirstOption(e){var t;if(e.options.length===0)return!1;for(let n=0;n<e.options.length;n++){const i=e.options[n];if(i.value!==""&&!i.disabled){e.focus(),e.selectedIndex=n;const s=(t=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value"))==null?void 0:t.set;return s&&s.call(e,i.value),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.blur(),!0}}return!1}async fillReactSelect(e,t,n,i=!1){if(n){const s=this.splitMultiSelectValues(t);let o=!1;for(const c of s){const l=await T.fillReactSelect(e,c,i);o=o||l}return o}return await T.fillReactSelect(e,t,i)}splitMultiSelectValues(e){const t=e.trim();if(!t)return[];if(t.startsWith("[")&&t.endsWith("]"))try{const n=JSON.parse(t);if(Array.isArray(n))return n.map(i=>String(i).trim()).filter(Boolean)}catch(n){}return t.split(/[;,\n]+/).map(n=>n.trim()).filter(Boolean)}async fillCheckbox(e,t,n=!1){const i=e.closest("fieldset");if(i&&n){const o=Array.from(i.querySelectorAll('input[type="checkbox"]')),c=t.split(",").map(l=>{const u=l.trim().match(/^#?(\d+)$/);return u?parseInt(u[1],10):null}).filter(l=>l!==null&&l>=0&&l<o.length);if(c.length>0){for(const l of c){const r=o[l];r&&!r.checked&&(r.focus(),await this.wait(50),r.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),r.click(),r.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),r.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),await this.wait(100))}return!0}else return!1}const s=["true","yes","1","on"].includes(t.toLowerCase());return e.checked!==s&&(e.focus(),await this.wait(50),e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0})),e.click(),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),await this.wait(100)),!0}async fillRadio(e,t){var o;const n=document.querySelectorAll(`input[type="radio"][name="${e.name}"]`),i=Array.from(n),s=t.trim().match(/^(?:#|index:|option-)?(\d+)$/i);if(s){const c=Number(s[1]);if(Number.isFinite(c)&&c>=0&&c<i.length)return i[c].click(),await this.wait(100),!0}for(const c of i){const l=document.querySelector(`label[for="${c.id}"]`);if((((o=l==null?void 0:l.textContent)==null?void 0:o.trim())||"").toLowerCase().includes(t.toLowerCase()))return c.click(),await this.wait(100),!0}return!1}}const x=new Ne,U={"+1":{countryCode:"+1",countryName:"United States",countryISO:"US"},"+44":{countryCode:"+44",countryName:"United Kingdom",countryISO:"GB"},"+48":{countryCode:"+48",countryName:"Poland",countryISO:"PL"},"+49":{countryCode:"+49",countryName:"Germany",countryISO:"DE"},"+33":{countryCode:"+33",countryName:"France",countryISO:"FR"},"+39":{countryCode:"+39",countryName:"Italy",countryISO:"IT"},"+34":{countryCode:"+34",countryName:"Spain",countryISO:"ES"},"+86":{countryCode:"+86",countryName:"China",countryISO:"CN"},"+91":{countryCode:"+91",countryName:"India",countryISO:"IN"},"+81":{countryCode:"+81",countryName:"Japan",countryISO:"JP"},"+82":{countryCode:"+82",countryName:"South Korea",countryISO:"KR"},"+61":{countryCode:"+61",countryName:"Australia",countryISO:"AU"},"+64":{countryCode:"+64",countryName:"New Zealand",countryISO:"NZ"},"+7":{countryCode:"+7",countryName:"Russia",countryISO:"RU"},"+55":{countryCode:"+55",countryName:"Brazil",countryISO:"BR"},"+52":{countryCode:"+52",countryName:"Mexico",countryISO:"MX"},"+54":{countryCode:"+54",countryName:"Argentina",countryISO:"AR"},"+56":{countryCode:"+56",countryName:"Chile",countryISO:"CL"},"+57":{countryCode:"+57",countryName:"Colombia",countryISO:"CO"},"+27":{countryCode:"+27",countryName:"South Africa",countryISO:"ZA"},"+20":{countryCode:"+20",countryName:"Egypt",countryISO:"EG"},"+234":{countryCode:"+234",countryName:"Nigeria",countryISO:"NG"},"+254":{countryCode:"+254",countryName:"Kenya",countryISO:"KE"},"+30":{countryCode:"+30",countryName:"Greece",countryISO:"GR"},"+31":{countryCode:"+31",countryName:"Netherlands",countryISO:"NL"},"+32":{countryCode:"+32",countryName:"Belgium",countryISO:"BE"},"+41":{countryCode:"+41",countryName:"Switzerland",countryISO:"CH"},"+43":{countryCode:"+43",countryName:"Austria",countryISO:"AT"},"+45":{countryCode:"+45",countryName:"Denmark",countryISO:"DK"},"+46":{countryCode:"+46",countryName:"Sweden",countryISO:"SE"},"+47":{countryCode:"+47",countryName:"Norway",countryISO:"NO"},"+351":{countryCode:"+351",countryName:"Portugal",countryISO:"PT"},"+353":{countryCode:"+353",countryName:"Ireland",countryISO:"IE"},"+358":{countryCode:"+358",countryName:"Finland",countryISO:"FI"},"+420":{countryCode:"+420",countryName:"Czech Republic",countryISO:"CZ"},"+421":{countryCode:"+421",countryName:"Slovakia",countryISO:"SK"},"+36":{countryCode:"+36",countryName:"Hungary",countryISO:"HU"},"+40":{countryCode:"+40",countryName:"Romania",countryISO:"RO"},"+359":{countryCode:"+359",countryName:"Bulgaria",countryISO:"BG"},"+380":{countryCode:"+380",countryName:"Ukraine",countryISO:"UA"},"+90":{countryCode:"+90",countryName:"Turkey",countryISO:"TR"},"+971":{countryCode:"+971",countryName:"United Arab Emirates",countryISO:"AE"},"+966":{countryCode:"+966",countryName:"Saudi Arabia",countryISO:"SA"},"+972":{countryCode:"+972",countryName:"Israel",countryISO:"IL"},"+65":{countryCode:"+65",countryName:"Singapore",countryISO:"SG"},"+60":{countryCode:"+60",countryName:"Malaysia",countryISO:"MY"},"+66":{countryCode:"+66",countryName:"Thailand",countryISO:"TH"},"+84":{countryCode:"+84",countryName:"Vietnam",countryISO:"VN"},"+63":{countryCode:"+63",countryName:"Philippines",countryISO:"PH"},"+62":{countryCode:"+62",countryName:"Indonesia",countryISO:"ID"},"+92":{countryCode:"+92",countryName:"Pakistan",countryISO:"PK"},"+880":{countryCode:"+880",countryName:"Bangladesh",countryISO:"BD"},"+94":{countryCode:"+94",countryName:"Sri Lanka",countryISO:"LK"},"+977":{countryCode:"+977",countryName:"Nepal",countryISO:"NP"}},Fe=(a,e)=>{};function ee(a){if(!a)return null;const e=a.trim(),t=e.startsWith("+")?e:`+${e}`;if(U[t])return U[t];for(const n of Object.keys(U))if(t.startsWith(n))return U[n];return null}function te(a,e){const t=ee(e);if(!t)return-1;Fe(`[PhoneUtils] Searching for country: ${t.countryName} (${t.countryCode})`);const n=[t.countryCode,t.countryCode.slice(1),t.countryName.toLowerCase(),t.countryISO.toLowerCase()];if(a instanceof HTMLOptionsCollection)for(let i=0;i<a.length;i++){const s=a[i];if(s.disabled||s.value==="")continue;const o=s.text.toLowerCase().trim(),c=s.value.toLowerCase().trim(),l=`${o} ${c}`;for(const r of n)if(l.includes(r))return i}else for(let i=0;i<a.length;i++){const s=a[i].toLowerCase().trim();for(const o of n)if(s.includes(o))return i}return-1}const ne=(a,e)=>{};class _e{async fillStandardFields(e,t,n){let i=0,s=0;const o=$(n),c=e.some(l=>l.key==="phoneCountry");ne("start",{totalFields:e.length});for(const l of e){if(!l.key){s++;continue}const r=o[l.key];if(!r){s++;continue}let u=r.getValue(t);if(l.key==="phone"&&c&&u&&(u=t.personalInfo.phone.number||void 0),l.key==="phoneCountry"&&u){const m=ee(u);if(m)u=m.countryCode;else{s++;continue}}const d=l.type==="select"||l.type==="react-select",p=l.type==="react-multi-select";if(d||p){if(!u){l.element instanceof HTMLSelectElement&&d&&await x.selectFirstOption(l.element)?i++:s++;continue}let m=!0;if(l.element instanceof HTMLSelectElement?m=await x.validateSelectValue(l.element,u):l.options&&l.options.length>0&&(m=await x.validateReactSelectValue(l.element,u,l.options)),!m){s++;continue}await x.fillField(l,u)?i++:s++;continue}if(!u){s++;continue}await x.fillField(l,u)?i++:s++}return ne("complete",{total:e.length}),{filledCount:i,totalFields:e.length,unmatchedCount:s}}}const Me=new _e,ie=(a,e)=>{};class $e{async fillEducationFields(e,t){var o;const n=(o=t.education)==null?void 0:o[0];if(!n)return ie("skipping: no education data",{totalFields:e.length}),{filledCount:0,totalFields:e.length,unmatchedCount:e.length};let i=0,s=0;for(const c of e){const l=this.getEducationValue(c,n);if(!l){s++;continue}await x.fillField(c,l)?i++:s++}return ie("complete",{total:e.length}),{filledCount:i,totalFields:e.length,unmatchedCount:s}}getEducationValue(e,t){var c,l;const n=e.label.toLowerCase(),i=((c=e.element.getAttribute("id"))==null?void 0:c.toLowerCase())||"",s=((l=e.element.getAttribute("name"))==null?void 0:l.toLowerCase())||"",o=`${n} ${i} ${s}`;return/school|university|college|institution/i.test(o)?t.school||null:/degree/i.test(o)?t.degree||null:/major|field|discipline/i.test(o)?t.major||null:/gpa/i.test(o)&&t.gpa?String(t.gpa):null}}const Re=new $e,N=(a,e)=>{b(`[CustomQuestions] ${a}`,e)};class De{async collectAIQuestions(e,t,n){if(e.length===0)return[];const{fieldsNeedingAI:i}=await this.classifyFields(e,t,n);return i.map((s,o)=>({id:this.buildQuestionId(s,o),type:this.mapFieldTypeToQuestionType(s.type),label:s.label,required:s.isRequired,options:s.options}))}async fillCustomQuestions(e,t,n){if(e.length===0)return N("skipping: no custom fields"),{filledCount:0,totalFields:0,unmatchedCount:0,aiQuestionsHandled:0};N("start",{totalFields:e.length}),N("field detection",{fields:e.map(d=>{var p,h;return{label:d.label,type:d.type,optionsLength:(h=(p=d.options)==null?void 0:p.length)!=null?h:0}})});const{fieldsWithKeys:i,fieldsWithDefinitions:s,fieldsNeedingAI:o}=await this.classifyFields(e,t,n),c=$(n);N("routing summary",{withKeys:i.length,withDefinitions:s.length,needingAI:o.length});let l=0,r=0;for(const d of i){const p=c[d.key],h=p==null?void 0:p.getValue(t);if(h)if(d.type==="select"||d.type==="react-select"||d.type==="react-multi-select"){let m=-1;if(d.key==="phoneCountry"||d.key==="country"){const g=d.key==="phoneCountry"?t.personalInfo.phone.countryCode:null,y=d.key==="country"?t.personalInfo.country:null;d.key==="phoneCountry"&&g?d.element instanceof HTMLSelectElement?m=te(d.element.options,g):d.options&&(m=te(d.options,g)):d.key==="country"&&y&&(d.element instanceof HTMLSelectElement?m=await this.findSelectOptionIndex(d.element,y):d.options&&(m=this.findReactSelectOptionIndex(d.options,y)))}else d.element instanceof HTMLSelectElement?m=await this.findSelectOptionIndex(d.element,h):d.options&&(m=this.findReactSelectOptionIndex(d.options,h));if(m>=0){const g=`#${m}`;await x.fillFieldWithAI(d,g,!0)?l++:r++}else r++}else await x.fillField(d,h)?l++:r++;else r++}for(const d of s){const p=G(d.label,d.type);if(p){const h=Le(p,d.options);if(h){const m=h.startsWith("#");await x.fillFieldWithAI(d,h,m)?l++:r++}else r++}}let u=0;if(o.length>0){N("sending questions to AI",{count:o.length});const d=o.map((h,m)=>({id:this.buildQuestionId(h,m),type:this.mapFieldTypeToQuestionType(h.type),label:h.label,required:h.isRequired,element:h.element,options:h.options}));N("ai questions",{questions:d.map(h=>{var m,g;return{id:h.id,label:h.label,type:h.type,optionsLength:(g=(m=h.options)==null?void 0:m.length)!=null?g:0}})});const p=await P.analyzeAndAnswerQuestions(d,t);N("AI answers received",{count:p.size});for(const h of o){const m=h.element.id||h.element.name||"",g=p.get(m);if(g){const y=g.startsWith("#")&&(h.type==="select"||h.type==="react-select"||h.type==="react-multi-select"||h.type==="checkbox"||h.type==="radio");await x.fillFieldWithAI(h,g,y)?(l++,u++):r++}else r++}}return N("complete",{filled:l,total:e.length,unmatched:r,aiQuestionsHandled:u}),{filledCount:l,totalFields:e.length,unmatchedCount:r,aiQuestionsHandled:u}}mapFieldTypeToQuestionType(e){switch(e){case"textarea":return"textarea";case"select":return"select";case"react-select":return"select";case"react-multi-select":return"multi_value_single_select";case"checkbox":return"checkbox";case"radio":return"select";default:return"text"}}buildQuestionId(e,t){return e.element.id||e.element.name||`question_${t}`}async classifyFields(e,t,n){const i=[],s=[],o=[],c=$(n),l=r=>G(r.label,r.type)?(s.push(r),!0):!1;for(const r of e){if(r.type==="select"||r.type==="react-select"||r.type==="react-multi-select"){if(r.key){const u=c[r.key];if(u){const d=u.getValue(t);if(d&&r.options&&r.options.length>0){let p=!1,h=-1;if(r.element instanceof HTMLSelectElement?(p=await x.validateSelectValue(r.element,d),p&&(h=await this.findSelectOptionIndex(r.element,d))):(p=await x.validateReactSelectValue(r.element,d,r.options),p&&(h=this.findReactSelectOptionIndex(r.options,d))),p&&h>=0){i.push(r);continue}}}}if(l(r))continue;o.push(r);continue}if(r.type==="checkbox"){if(r.key){const u=c[r.key];if(u==null?void 0:u.getValue(t)){i.push(r);continue}}if(l(r))continue;o.push(r);continue}if(r.key)i.push(r);else{if(l(r))continue;o.push(r)}}return{fieldsWithKeys:i,fieldsWithDefinitions:s,fieldsNeedingAI:o}}async findSelectOptionIndex(e,t){const n=t.toLowerCase().trim();for(let i=0;i<e.options.length;i++){const s=e.options[i];if(s.value===""||s.disabled)continue;const o=s.value.toLowerCase().trim(),c=s.text.toLowerCase().trim();if(o===n||c===n||o.includes(n)||c.includes(n))return i}return-1}findReactSelectOptionIndex(e,t){const n=t.toLowerCase().trim(),i=this.normalizeText(t);for(let s=0;s<e.length;s++){const o=e[s],c=o.toLowerCase().trim(),l=this.normalizeText(o);if(c===n||c.includes(n)||l.includes(i))return s}return-1}normalizeText(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}}const oe=new De;class Ve{constructor(){this.profile=null,this.cachedFields=null,this.cachedEngineMode=null,this.cachedAt=0,this.cacheTtlMs=5e3}setProfile(e){this.profile=e}setOpenAIKey(e){P.setApiKey(e)}setAIAnswerOverrides(e){P.setAnswerOverrides(e)}setAIAnswerDebug(e){P.setAnswerDebug(e)}async collectAIQuestions(){if(!this.profile)return[];const e=await this.decideEngineMode(void 0);await z.setEngineMode(e),T.setEngineMode(e);const t=await z.collectAllFormFields();this.cacheFieldCollection(t,e);const n=Z.categorizeFields(t),i=await this.getUnmatchedStandardFields(n.standard,this.profile,e),s=[...n.custom,...i],o=await oe.collectAIQuestions(s,this.profile,e);return b("[DomainEngine] AI question payload",{count:o.length,labels:o.map(c=>c.label)}),o}async decideEngineMode(e){if(!e&&e!=="common"&&e!==void 0)return e;const t=window.location.href.toLowerCase();switch(!0){case t.includes("greenhouse.io"):return"greenhouse";case t.includes("myworkdayjobs.com"):return"workday";default:return"common"}}async autofillDomainPage(e){if(!this.profile)return b("start: missing profile"),{filledCount:0,totalFields:0,unmatchedCount:0,aiQuestionsHandled:0};const t=await this.decideEngineMode(e);b("[DomainEngine] Engine mode:",{engineMode:t}),await z.setEngineMode(t),T.setEngineMode(t);const n=this.consumeFieldCollection(t),i=n!=null?n:await z.collectAllFormFields();b("field collection complete",{totalFields:i.length});const s=Z.categorizeFields(i),o=await Me.fillStandardFields(s.standard,this.profile,t);b("standard fields filled",{filled:o.filledCount,total:o.totalFields,unmatched:o.unmatchedCount});const c=await this.getUnmatchedStandardFields(s.standard,this.profile,t);b("unmatched standard fields",{count:c.length});const l=[...s.custom,...c],r=await Re.fillEducationFields(s.education,this.profile);b("education fields filled",{filled:r.filledCount,total:r.totalFields,unmatched:r.unmatchedCount});const u=await oe.fillCustomQuestions(l,this.profile,t);b("custom fields filled",{filled:u.filledCount,total:u.totalFields,unmatched:u.unmatchedCount,aiQuestionsHandled:u.aiQuestionsHandled||0});const d=this.calculateTotals([o,r,u]);return b("greenhouse autofill complete",{filled:d.filledCount,total:d.totalFields,unmatched:d.unmatchedCount}),Q(K({},d),{aiQuestionsHandled:u.aiQuestionsHandled||0})}async getUnmatchedStandardFields(e,t,n){const i=[],s=$(n);for(const o of e){if(!o.key)continue;const c=s[o.key];if(!c)continue;const l=c.getValue(t),r=o.type==="select"||o.type==="react-select",u=o.type==="react-multi-select";if((r||u)&&l){let d=!0;o.element instanceof HTMLSelectElement?d=await x.validateSelectValue(o.element,l):o.options&&o.options.length>0&&(d=await x.validateReactSelectValue(o.element,l,o.options)),d||i.push(o)}}return i}cacheFieldCollection(e,t){this.cachedFields=e,this.cachedEngineMode=t,this.cachedAt=Date.now()}consumeFieldCollection(e){if(!this.cachedFields||!this.cachedEngineMode)return null;const t=Date.now()-this.cachedAt;if(this.cachedEngineMode!==e||t>this.cacheTtlMs)return this.cachedFields=null,this.cachedEngineMode=null,this.cachedAt=0,null;const n=this.cachedFields;return this.cachedFields=null,this.cachedEngineMode=null,this.cachedAt=0,b("using cached field collection",{totalFields:n.length}),n}calculateTotals(e){return e.reduce((t,n)=>({filledCount:t.filledCount+n.filledCount,totalFields:t.totalFields+n.totalFields,unmatchedCount:t.unmatchedCount+n.unmatchedCount}),{filledCount:0,totalFields:0,unmatchedCount:0})}}const M=new Ve;class qe{constructor(){this.profile=null,this.engineMode="common"}setProfile(e){this.profile=e}setEngineMode(e){this.engineMode=e}setOpenAIKey(e){M.setOpenAIKey(e)}setAIAnswerOverrides(e){M.setAIAnswerOverrides(e)}setAIAnswerDebug(e){M.setAIAnswerDebug(e)}async collectDomainAIQuestions(){return this.profile?(M.setProfile(this.profile),M.collectAIQuestions()):[]}async autofillPage(){if(!this.profile)return console.warn("No profile set for autofill"),{filledCount:0,totalFields:0,unmatchedCount:0,unknownCount:0};this.isSpecificPage(),M.setProfile(this.profile);const e=await M.autofillDomainPage(this.engineMode);return{filledCount:e.filledCount,totalFields:e.totalFields,unmatchedCount:e.unmatchedCount,unknownCount:0,aiQuestionsHandled:e.aiQuestionsHandled}}isSpecificPage(){var t;const e=document.querySelectorAll("iframe");for(const n of e)if((((t=n.src)==null?void 0:t.toLowerCase())||"").includes("greenhouse.io/embed/job_app"))throw window.open(n.src,"_blank"),new Error("GREENHOUSE_IFRAME_REDIRECT");return!1}async defaultAutofill(){const e=document.querySelectorAll('input:not([type="submit"]):not([type="button"]):not([type="image"]):not([type="hidden"]):not([type="checkbox"]):not([type="radio"]):not([type="file"]), textarea, select');let t=0,n=0,i=0;const s=e.length;console.log(`Found ${s} fillable fields`);for(const o of e){const c=A(o);if(c){const l=I[c];if(console.log(`Matched field: ${c} for element:`,o),l.handleSpecialCases)try{await l.handleSpecialCases(o,this.profile),t++}catch(r){console.error(`Error in special case handler for ${c}:`,r),n++}else{const r=l.getValue(this.profile);if(r)try{if(o instanceof HTMLSelectElement){const u=this.isSearchableSelect(o);await S.fillSelect(o,r,{searchable:u})?(t++,console.log(`Successfully filled ${c}: ${r}`)):(n++,console.warn(`Failed to fill ${c}, no matching option for: ${r}`))}else await S.fillInput(o,r),t++,console.log(`Successfully filled ${c}: ${r}`)}catch(u){console.error(`Error filling field ${c}:`,u),n++}else n++,console.log(`Matched field "${c}" but no value in profile for:`,o)}}else i++,console.log("Unknown field (no pattern match):",{element:o,name:o.getAttribute("name"),id:o.getAttribute("id"),placeholder:o.getAttribute("placeholder"),ariaLabel:o.getAttribute("aria-label")})}return console.log(`Autofilled ${t}/${s} fields, unmatched: ${n}, unknown: ${i}`),{filledCount:t,totalFields:s,unmatchedCount:n,unknownCount:i}}isSearchableSelect(e){const t=e.parentElement;return t?[t.querySelector('[class*="select"]'),t.querySelector('[class*="Select"]'),t.querySelector('[class*="dropdown"]'),t.querySelector('[class*="Dropdown"]'),t.classList.contains("v-select"),t.querySelector(".vs__dropdown-toggle"),t.querySelector("mat-select"),e.getAttribute("mat-select")!==null,t.classList.contains("ui")&&t.classList.contains("dropdown"),e.classList.contains("selectize-input"),e.classList.contains("select2-hidden-accessible")].some(i=>i):!1}}const k=new qe,se=a=>{var s,o,c,l,r,u,d,p,h,m,g,y,w,f,E,v,F,C,L,q,_,O,B,H,re,ae,le,ce,ue,de,pe,fe,he,me,ge,ye,be,we,Se;const e=a&&typeof a=="object"?a:{},t=(s=e.personalInfo)!=null?s:{},n=(o=t.phone)!=null?o:{},i=(c=e.additionalInfo)!=null?c:{};return{id:(l=e.id)!=null?l:"",name:(r=e.name)!=null?r:"",personalInfo:{prefix:(u=t.prefix)!=null?u:"",firstName:(d=t.firstName)!=null?d:"",middleName:(p=t.middleName)!=null?p:"",lastName:(h=t.lastName)!=null?h:"",familyName:(g=(m=t.familyName)!=null?m:t.lastName)!=null?g:"",address:(y=t.address)!=null?y:"",streetName:(f=(w=t.streetName)!=null?w:t.address)!=null?f:"",city:(E=t.city)!=null?E:"",state:(v=t.state)!=null?v:"",postalCode:(F=t.postalCode)!=null?F:"",country:(C=t.country)!=null?C:"",email:(L=t.email)!=null?L:"",password:(q=t.password)!=null?q:"",phone:{countryCode:(_=n.countryCode)!=null?_:"",number:(O=n.number)!=null?O:""},nationality:(B=t.nationality)!=null?B:"",linkedInURL:(H=t.linkedInURL)!=null?H:"",twitterURL:(re=t.twitterURL)!=null?re:"",githubURL:(ae=t.githubURL)!=null?ae:"",website:(le=t.website)!=null?le:"",gender:(ce=t.gender)!=null?ce:""},additionalInfo:{currentSalary:(ue=i.currentSalary)!=null?ue:"",expectedSalary:(de=i.expectedSalary)!=null?de:"",noticePeriod:(pe=i.noticePeriod)!=null?pe:"",earliestAvailableDate:(fe=i.earliestAvailableDate)!=null?fe:"",coverLetter:(he=i.coverLetter)!=null?he:"",genderIdentity:(me=i.genderIdentity)!=null?me:"",raceEthnicity:(ge=i.raceEthnicity)!=null?ge:"",sexualOrientation:(ye=i.sexualOrientation)!=null?ye:"",disabilityStatus:(be=i.disabilityStatus)!=null?be:"",veteranStatus:(we=i.veteranStatus)!=null?we:""},education:Array.isArray(e.education)?e.education:[],workExperience:Array.isArray(e.workExperience)?e.workExperience:[],resume:(Se=e.resume)!=null?Se:null}};async function Be(a,e){const t=se(a),n=e!=null?e:{},i=n.engineMode==="greenhouse"||n.engineMode==="common"?n.engineMode:"auto",s=typeof n.openaiApiKey=="string"?n.openaiApiKey.trim():"",o=Array.isArray(n.aiAnswerOverrides)?n.aiAnswerOverrides:null,c=n.aiAnswerDebug&&typeof n.aiAnswerDebug=="object"?{prompt:typeof n.aiAnswerDebug.prompt=="string"?n.aiAnswerDebug.prompt:void 0,rawResponse:typeof n.aiAnswerDebug.rawResponse=="string"?n.aiAnswerDebug.rawResponse:void 0}:null,l=!!n.debug,r=typeof n.debugTag=="string"&&n.debugTag.trim()?n.debugTag.trim():"",d=l?(()=>{const m={log:console.log,info:console.info,warn:console.warn,error:console.error},g=y=>(...w)=>y(r,...w);return console.log=g(m.log),console.info=g(m.info),console.warn=g(m.warn),console.error=g(m.error),()=>{console.log=m.log,console.info=m.info,console.warn=m.warn,console.error=m.error}})():null;k.setProfile(t),k.setEngineMode(i),k.setAIAnswerOverrides(o),k.setAIAnswerDebug(c),s&&k.setOpenAIKey(s);let p="";const h=window.open;window.open=m=>(m&&(p=typeof m=="string"?m:m.toString()),null);try{const m=await k.autofillPage();return p?{success:!1,redirectUrl:p,engine:"greenhouse"}:{success:!0,engine:"aiQuestionsHandled"in m?"greenhouse":"common",filledCount:m.filledCount,totalFields:m.totalFields,unmatchedCount:m.unmatchedCount,unknownCount:m.unknownCount,aiQuestionsHandled:m.aiQuestionsHandled}}catch(m){return p?{success:!1,redirectUrl:p,engine:"greenhouse"}:{success:!1,error:m instanceof Error?m.message:"Autofill failed"}}finally{window.open=h,d&&d()}}async function He(a,e){const t=se(a),n=e!=null?e:{},i=n.engineMode==="greenhouse"||n.engineMode==="common"?n.engineMode:"auto",s=!!n.debug,o=typeof n.debugTag=="string"&&n.debugTag.trim()?n.debugTag.trim():"",l=s?(()=>{const r={log:console.log,info:console.info,warn:console.warn,error:console.error},u=d=>(...p)=>d(o,...p);return console.log=u(r.log),console.info=u(r.info),console.warn=u(r.warn),console.error=u(r.error),()=>{console.log=r.log,console.info=r.info,console.warn=r.warn,console.error=r.error}})():null;k.setProfile(t),k.setEngineMode(i);try{return await k.collectDomainAIQuestions()}finally{l&&l()}}typeof window!="undefined"&&(window.autofillRuntime=Be,window.autofillCollectDomainQuestions=He)})();
